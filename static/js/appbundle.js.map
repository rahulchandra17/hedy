{
  "version": 3,
  "sources": ["index.ts", "modal.ts", "syntaxModesRules.ts", "teachers.ts", "auth.ts", "app.ts", "tabs.ts", "translating.ts"],
  "sourcesContent": ["export * from './modal';\r\nexport * from './app';\r\nexport * from './auth';\r\nimport './syntaxModesRules';\r\nimport './tabs';\r\nimport './translating';\r\nexport * from './teachers';", "/**\r\n * The modal we pop up to have children confirm things\r\n */\r\nclass Modal {\r\n  constructor() {\r\n    // Just one binding, never needs stat\r\n    $('#modal-confirm-button').on('click', () => this.hide());\r\n    $('#modal-no-button').on('click', () => this.hide());\r\n    $('#modal-cancel-button').on('click', () => this.hide());\r\n  }\r\n\r\n  public show() {\r\n    $('#modal-mask').show();\r\n    $('#modal-content').show();\r\n    window.scrollTo(0, 0);\r\n  }\r\n\r\n  public hide() {\r\n    $('#modal-mask').hide();\r\n    $('#modal-content').hide();\r\n    $('#modal-alert').hide();\r\n    $('#modal-prompt').hide();\r\n    $('#modal-confirm').hide();\r\n  }\r\n\r\n  public alert(message: string, timeoutMs?: number) {\r\n    $('#modal-alert-text').text(message);\r\n    this.show();\r\n    $('#modal-alert').show();\r\n    if (timeoutMs) setTimeout(() => this.hide(), timeoutMs);\r\n  }\r\n\r\n  public confirm(message: string, confirmCb: () => void) {\r\n    $('#modal-confirm-text').text(message);\r\n    this.show();\r\n    $('#modal-confirm').show();\r\n\r\n    // Since we need to close over the callback, replace the handler\r\n    $('#modal-yes-button').off('click').on('click', () => {\r\n      this.hide();\r\n      confirmCb();\r\n    });\r\n  }\r\n\r\n  public prompt(message: string, defaultValue: string, confirmCb: (x: string) => void) {\r\n    $('#modal-prompt-text').text(message);\r\n    this.show();\r\n    $('#modal-prompt').show();\r\n    if (defaultValue) $('#modal-prompt-input').val(defaultValue);\r\n\r\n    // Since we need to close over the callback, replace the handler\r\n    $('#modal-ok-button').off('click').on('click', () => {\r\n      this.hide();\r\n\r\n      const value = $('#modal-prompt-input').val();\r\n      if (typeof value === 'string') {\r\n        confirmCb(value);\r\n      }\r\n    });\r\n  }\r\n}\r\n\r\nlet editor: AceAjax.Editor | undefined;\r\n\r\n/**\r\n * The error that appears underneath the code editor\r\n */\r\nexport const success = {\r\n  setEditor(e: AceAjax.Editor) {\r\n    editor = e;\r\n  },\r\n\r\n  hide: function () {\r\n    $('#okbox').hide();\r\n    editor?.resize();\r\n\r\n  },\r\n\r\n  showWarning(caption: string, message: string) {\r\n    $('#okbox .caption').text(caption);\r\n    $('#okbox .details').text(message);\r\n    $('#okbox').show();\r\n    editor?.resize();\r\n  },\r\n\r\n  show(caption: string) {\r\n    $('#okbox .caption').text(caption);\r\n    $('#okbox').show();\r\n    editor?.resize();\r\n    setTimeout(function(){     $('#okbox').hide();\r\n    editor?.resize(); }, 3000);\r\n  }\r\n}\r\n\r\nexport const error = {\r\n  setEditor(e: AceAjax.Editor) {\r\n    editor = e;\r\n  },\r\n\r\n  hide() {\r\n    $('#errorbox').hide();\r\n    $('#warningbox').hide();\r\n    editor?.resize();\r\n  },\r\n\r\n  showWarning(caption: string, message: string) {\r\n    $('#warningbox .caption').text(caption);\r\n    $('#warningbox .details').text(message);\r\n    $('#warningbox').show();\r\n    editor?.resize();\r\n  },\r\n\r\n  show(caption: string, message: string) {\r\n    $('#errorbox .caption').text(caption);\r\n    $('#errorbox .details').html(message);\r\n    $('#errorbox').show();\r\n    editor?.resize();\r\n  }\r\n}\r\n\r\nexport const modal = new Modal();\r\n", "import './syntaxKeywords'\r\n\r\ninterface Rule {\r\n  readonly regex: string;\r\n  readonly token: string | string[];\r\n  readonly next?: string;\r\n}\r\n\r\ntype Rules = Record<string, Rule[]>;\r\n\r\n// Basic highlighter rules we can use in most levels\r\n// - Highlighters always begin in the 'start' state, and see line by line (no newlines!)\r\n// - We try to recognize as many commands and tokens as possible in 'start', only deviating\r\n//   to another state to avoid highlighting something.\r\n// - 'expression_eol' is the state to contain arbitrary values that will always eat the rest of the line\r\n// - 'gobble' is the state that will eat whatever is left in the line and go back to 'start'\r\nfunction baseRules(): Rules {\r\n  return {\r\n    // gobble is a state in which we can read anything (.*), used after print\r\n    gobble: [\r\n      {\r\n        regex: '.*',\r\n        token: 'text',\r\n        next: 'start',\r\n      }\r\n    ],\r\n\r\n    // this function creates two rules, one to recognize strings and at random within a line (staying in the same state)\r\n    // and one where it is recognized at the end of the line (going back to start)\r\n    expression_eol: finishLine([\r\n      {\r\n        regex: \"'[^']*'\",\r\n        token: 'constant.character',\r\n      },\r\n      {\r\n        regex: _AT + ' ' + random,\r\n        token: 'keyword'\r\n      },\r\n      {\r\n        regex: '$', // $ matches with end of line\r\n        token: 'text',\r\n      },\r\n    ]),\r\n  };\r\n}\r\n\r\nconst LEVELS = [\r\n  {\r\n    name: 'level1',\r\n    rules: pipe(baseRules(),\r\n      rule_printSpace('gobble'),\r\n      rule_turtle(),\r\n      recognize('start', {\r\n        regex: keywordWithSpace(_ECHO),\r\n        token: 'keyword',\r\n        next: 'gobble',\r\n      }),\r\n      recognize('start', {\r\n        regex: keywordWithSpace(_ASK),\r\n        token: 'keyword',\r\n        next: 'gobble',\r\n      }),\r\n    ),\r\n  },\r\n  {\r\n    // Adds lists and 'at random'\r\n    name: 'level2',\r\n    rules: pipe(baseRules(),\r\n\r\n      rule_printSpace('expression_eol'),\r\n      rule_isAsk('gobble'),\r\n      rule_is('gobble'),\r\n      rule_turtle(),\r\n      rule_sleep(),\r\n\r\n    ),\r\n  },\r\n  {\r\n    // Adds quoted text\r\n    name: 'level3',\r\n    rules: pipe(baseRules(),\r\n      rule_turtle(),\r\n      rule_printSpace('expression_eol'),\r\n      rule_isAsk(),\r\n      rule_is(),\r\n    ),\r\n  },\r\n  {\r\n    // Adds if/else\r\n    name: 'level4',\r\n    rules: pipe(baseRules(),\r\n      rule_printSpace(),\r\n      rule_isAsk(),\r\n      rule_is(),\r\n      rule_ifElseOneLine(),\r\n      rule_expressions(),\r\n    ),\r\n  },\r\n  {\r\n    // Adds repeat\r\n    name: 'level5',\r\n    rules: pipe(baseRules(),\r\n      rule_printSpace(),\r\n      rule_isAsk(),\r\n      rule_is(),\r\n      rule_ifElseOneLine(),\r\n      rule_expressions(),\r\n      rule_repeat(),\r\n    ),\r\n  },\r\n  {\r\n    // Adds arithmetic\r\n    name: 'level6',\r\n    rules: pipe(baseRules(),\r\n      rule_printSpace(),\r\n      rule_isAsk(),\r\n      rule_is(),\r\n      rule_ifElseOneLine(),\r\n      rule_expressions(),\r\n      rule_repeat(),\r\n      rule_arithmetic(),\r\n    ),\r\n  },\r\n  {\r\n    // Adds indented blocks -- no changes to highlighter necessary\r\n    name: 'level7',\r\n    rules: pipe(baseRules(),\r\n      rule_printSpace(),\r\n      rule_isAsk(),\r\n      rule_is(),\r\n      rule_ifElse(),\r\n      rule_expressions(),\r\n      rule_repeat(),\r\n      rule_arithmetic(),\r\n    ),\r\n  },\r\n  {\r\n    // Replaces 'repeat' with 'for'\r\n    name: 'level8',\r\n    rules: pipe(baseRules(),\r\n      rule_printSpace(),\r\n      rule_isAsk(),\r\n      rule_is(),\r\n      rule_ifElse(),\r\n      rule_expressions(),\r\n      rule_arithmetic(),\r\n      rule_for()\r\n    ),\r\n  },\r\n  {\r\n    // Replaces 'repeat' with 'for'\r\n    name: 'level9and10',\r\n    rules: pipe(baseRules(),\r\n      rule_printSpace(),\r\n      rule_isAsk(),\r\n      rule_is(),\r\n      rule_ifElse(),\r\n      rule_expressions(),\r\n      rule_arithmetic(),\r\n      rule_forRange(),\r\n      rule_for()\r\n    ),\r\n  },\r\n  {\r\n    // Nesting of 'for' loops (no changes necessary)\r\n    name: 'level11',\r\n    rules: pipe(baseRules(),\r\n      rule_printSpace(),\r\n      rule_isAsk(),\r\n      rule_is(),\r\n      rule_ifElse(),\r\n      rule_expressions(),\r\n      rule_arithmetic(),\r\n      rule_forRange(),\r\n    ),\r\n  },\r\n  {\r\n    // Adding fncall parens\r\n    name: 'level12',\r\n    rules: pipe(baseRules(),\r\n      rule_printParen(),\r\n      rule_isInputParen(),\r\n      rule_is(),\r\n      rule_ifElse(),\r\n      rule_expressions(),\r\n      rule_arithmetic(),\r\n      rule_forRangeParen(),\r\n    ),\r\n  },\r\n// ----------------------------------------------------------------\r\n//  Everything below this line hasn't been done yet\r\n// ----------------------------------------------------------------\r\n  {\r\n    name: 'level11',\r\n    rules: pipe(baseRules(),\r\n      rule_printParen(),\r\n      rule_isInputParen(),\r\n      rule_is(),\r\n      rule_ifElse(),\r\n      rule_expressions(),\r\n      rule_arithmetic(),\r\n      rule_forRangeParen(),\r\n    ),\r\n  },\r\n  {\r\n    name: 'level13',\r\n    rules: pipe(baseRules(),\r\n      rule_printParen(),\r\n      rule_isInputParen(),\r\n      rule_is(),\r\n      rule_ifElse(),\r\n      rule_expressions(),\r\n      rule_arithmetic(),\r\n      rule_forRangeParen(),\r\n    ),\r\n  },\r\n  {\r\n    name: 'level14',\r\n    rules: pipe(baseRules(),\r\n      rule_printParen(),\r\n      rule_isInputParen(),\r\n      rule_is(),\r\n      rule_ifElse(),\r\n      rule_expressions(),\r\n      rule_arithmetic(),\r\n      rule_forRangeParen(),\r\n    ),\r\n  },\r\n  {\r\n    name: 'level15',\r\n    rules: pipe(baseRules(),\r\n      rule_printParen(),\r\n      rule_isInputParen(),\r\n      rule_is(),\r\n      rule_ifElse(),\r\n      rule_expressions(),\r\n      rule_arithmetic(),\r\n      rule_forRangeParen(),\r\n    ),\r\n  },\r\n  {\r\n    name: 'level16',\r\n    rules: pipe(baseRules(),\r\n      rule_printParen(),\r\n      rule_isInputParen(),\r\n      rule_is(),\r\n      rule_ifElse(),\r\n      rule_expressions(),\r\n      rule_arithmetic(),\r\n      rule_forRangeParen(),\r\n    ),\r\n  },\r\n  {\r\n    name: 'level17',\r\n    rules: pipe(baseRules(),\r\n      rule_printParen(),\r\n      rule_isInputParen(),\r\n      rule_is(),\r\n      rule_ifElse(),\r\n      rule_expressions(),\r\n      rule_arithmetic(),\r\n      rule_forRangeParen(),\r\n    ),\r\n  },\r\n  {\r\n    name: 'level18and19',\r\n    rules: pipe(baseRules(),\r\n      rule_printParen(),\r\n      rule_isInputParen(),\r\n      rule_is(),\r\n      rule_ifElse(),\r\n      rule_expressions(),\r\n      rule_arithmetic(),\r\n      rule_forRangeParen(),\r\n    ),\r\n  },\r\n  {\r\n    name: 'level20',\r\n    rules: pipe(baseRules(),\r\n      rule_printParen(),\r\n      rule_isInputParen(),\r\n      rule_is(),\r\n      rule_ifElse(),\r\n      rule_expressions(),\r\n      rule_arithmetic(),\r\n      rule_forRangeParen(),\r\n    ),\r\n  },\r\n  {\r\n    name: 'level21',\r\n    rules: pipe(baseRules(),\r\n      rule_printParen(),\r\n      rule_isInputParen(),\r\n      rule_is(),\r\n      rule_ifElse(),\r\n      rule_expressions(),\r\n      rule_arithmetic(),\r\n      rule_forRangeParen(),\r\n    ),\r\n  },\r\n  {\r\n    name: 'level22',\r\n    rules: pipe(baseRules(),\r\n      rule_printParen(),\r\n      rule_isInputParen(),\r\n      rule_is(),\r\n      rule_ifElse(),\r\n      rule_expressions(),\r\n      rule_arithmetic(),\r\n      rule_forRangeParen(),\r\n    ),\r\n  },\r\n  {\r\n    name: 'level23',\r\n    rules: pipe(baseRules(),\r\n      rule_printParen(),\r\n      rule_isInputParen(),\r\n      rule_is(),\r\n      rule_ifElse(),\r\n      rule_expressions(),\r\n      rule_arithmetic(),\r\n      rule_forRangeParen(),\r\n    ),\r\n  },\r\n];\r\n\r\n\r\n/**\r\n * From a list of rules, duplicate all rules\r\n *\r\n * - 1 is the rule that's given\r\n * - 2 is the same rule, adding an '$' which returns to the 'start' state\r\n *\r\n * 2nd one comes first to have the right precedence.\r\n */\r\nfunction finishLine(rules: Rule[]) {\r\n  const ret = [];\r\n  for (const rule of rules) {\r\n    if (rule.regex) {\r\n      ret.push({\r\n        regex: rule.regex + '$',\r\n        token: rule.token,\r\n        next: 'start',\r\n      });\r\n    }\r\n    ret.push(rule);\r\n  }\r\n  return ret;\r\n}\r\n\r\n/**\r\n * Add a single rule, or multiple rules, to a given state, or multiple states\r\n *\r\n * Examples:\r\n *\r\n * - recognize('start', { regex, token, next })\r\n * - recognize(['start', 'expression'], { regex, token, next })\r\n * - recognize('start', [{ ... }, {...}])\r\n */\r\nfunction recognize(stateOrStates: string | string[], ruleOrRules: Rule | Rule[]) {\r\n  return (rules: Rules) => {\r\n    if (!Array.isArray(stateOrStates)) {\r\n      stateOrStates = [stateOrStates];\r\n    }\r\n\r\n    for (const state of stateOrStates) {\r\n      if (!rules[state]) {\r\n        rules[state] = [];\r\n      }\r\n      if (Array.isArray(ruleOrRules)) {\r\n        rules[state].push(...ruleOrRules);\r\n      } else {\r\n        rules[state].push(ruleOrRules);\r\n      }\r\n    }\r\n\r\n    return rules;\r\n  };\r\n}\r\n\r\n/**\r\n * comp(f1, f2, f3, ...)\r\n *\r\n * Returns f1 \u25CB f2 \u25CB f3 \u25CB ...\r\n */\r\nfunction comp(...fns: Array<(x: any) => any>) {\r\n  return (val: any) => {\r\n    for (const fn of fns) {\r\n      val = fn(val);\r\n    }\r\n    return val;\r\n  };\r\n}\r\n\r\n/**\r\n * pipe(X, f1, f2, f3, ...)\r\n *\r\n * Returns ...(f3(f2(f1(X)))\r\n *\r\n * (Same as X |> f1 |> f2 |> f3 |> ...)\r\n */\r\nfunction pipe(val: any, ...fns: Array<(x: any) => any>) {\r\n  return comp(...fns)(val);\r\n}\r\n\r\n/**\r\n * Add a 'print' rule, going to the indicated 'next' state (start if omitted)\r\n */\r\nfunction rule_printSpace(next?: string) {\r\n  return recognize('start', {\r\n    regex: keywordWithSpace(_PRINT),\r\n    token: 'keyword',\r\n    next: next ?? 'start',\r\n  });\r\n}\r\n\r\n/**\r\n * Add an 'is ask' rule, going to the indicated 'next' state (expression_eol if omitted)\r\n */\r\nfunction rule_isAsk(next?: string) {\r\n  return recognize('start', {\r\n    regex: '(\\\\w+)( ' + _IS + ' ' + _ASK + ')',\r\n    token: ['text', 'keyword'],\r\n    next: next ?? 'expression_eol',\r\n  });\r\n}\r\n\r\n/**\r\n * Add an 'is' rule, going to the indicated 'next' state (expression_eol if omitted)\r\n */\r\nfunction rule_is(next?: string) {\r\n  return recognize('start', {\r\n    regex: '(\\\\w+)( ' + _IS + ' )',\r\n    token: ['text', 'keyword'],\r\n    next: next ?? 'expression_eol',\r\n  });\r\n}\r\n\r\n/**\r\n * Add a 'print' rule with brackets\r\n */\r\nfunction rule_printParen() {\r\n  return recognize('start', {\r\n    regex: '(' + _PRINT + ')(\\\\()',\r\n    token: ['keyword', 'paren.lparen'],\r\n    next: 'start'\r\n  });\r\n}\r\n\r\nfunction rule_turtle() {\r\n    return comp(\r\n      recognize('start', {\r\n        // Note: left and right are not yet keywords\r\n        regex: _TURN + ' (left|right)?',\r\n        token: 'keyword',\r\n        next: 'start',\r\n      }),\r\n      recognize('start', {\r\n        regex: _FORWARD,\r\n        token: 'keyword',\r\n        next: 'start',\r\n      })\r\n    )\r\n}\r\n\r\nfunction rule_sleep() {\r\n  return recognize('start', {\r\n      regex: 'sleep',\r\n      token: 'keyword',\r\n      next: 'start',\r\n    }\r\n  )\r\n}\r\n\r\n\r\n\r\n\r\n\r\n/**\r\n * Add an 'is input' rule with brackets\r\n */\r\nfunction rule_isInputParen() {\r\n  return recognize('start', {\r\n    regex: '(\\\\w+)( ' + _IS + ' ' + _INPUT + ')(\\\\()',\r\n    token: ['text', 'keyword', 'paren.lparen'],\r\n    next: 'start'\r\n  });\r\n}\r\n\r\n/**\r\n * Recognize expressions as part of the 'start' state\r\n */\r\nfunction rule_expressions() {\r\n  return comp(\r\n    recognize('start', {\r\n      regex: \"'[^']*'\",\r\n      token: 'constant.character',\r\n    }),\r\n    recognize('start', {\r\n      regex: _AT + random,\r\n      token: 'keyword'\r\n    }),\r\n    recognize('start', {\r\n      regex: '[, ]+',\r\n      token: 'punctuation.operator',\r\n    }),\r\n  );\r\n}\r\n\r\n\r\n/**\r\n * Add highlighting for if/else, also add a condition\r\n */\r\nfunction rule_ifElseOneLine() {\r\n  return comp(\r\n    recognize('start', {\r\n      regex: keywordWithSpace(_IF),\r\n      token: 'keyword',\r\n      next: 'condition',\r\n    }),\r\n    recognize('start', {\r\n      regex: keywordWithSpace(_ELSE),\r\n      token: 'keyword',\r\n    }),\r\n    recognize('condition', {\r\n      regex: keywordWithSpace('((' + _IS + ')|(' + _IN + '))'),\r\n      token: 'keyword',\r\n      next: 'start',\r\n    }),\r\n  );\r\n}\r\n\r\nfunction rule_ifElse() {\r\n  return comp(\r\n    recognize('start', {\r\n      regex: keywordWithSpace(_IF),\r\n      token: 'keyword',\r\n      next: 'condition',\r\n    }),\r\n    recognize('start', {\r\n      regex: '\\\\b' + _ELSE + '\\\\b',\r\n      token: 'keyword',\r\n    }),\r\n    recognize('condition', {\r\n      regex: keywordWithSpace('((' + _IS + ')|(' + _IN + '))'),\r\n      token: 'keyword',\r\n      next: 'start',\r\n    }),\r\n  );\r\n}\r\n\r\n/**\r\n * Add numbers and arithmetic\r\n */\r\nfunction rule_arithmetic() {\r\n  return recognize(['start', 'expression_eol'], [\r\n    {\r\n      regex: ' \\\\* ',\r\n      token: 'keyword',\r\n    },\r\n    {\r\n      regex: ' \\\\+ ',\r\n      token: 'keyword',\r\n    },\r\n    {\r\n      regex: ' \\\\- ',\r\n      token: 'keyword',\r\n    },\r\n  ]);\r\n}\r\n\r\n/**\r\n * Add highlighting for repeat\r\n */\r\nfunction rule_repeat() {\r\n  return recognize('start', {\r\n    regex: '(' + _REPEAT + ')( \\\\w+ )(' + _TIMES + ')',\r\n    token: ['keyword', 'text', 'keyword'],\r\n  });\r\n}\r\n\r\nfunction rule_for(){\r\n  return recognize('start', {\r\n    regex: '(' + _FOR + ' )(\\\\w+)( ' + _IN + ' )(\\\\w+)',\r\n    token: ['keyword', 'text', 'keyword', 'text'],\r\n  });\r\n}\r\n\r\nfunction rule_forRange() {\r\n  return recognize('start', {\r\n    regex: '(' + _FOR + ' )(\\\\w+)( ' + _IN + ' ' + _RANGE + ' )(\\\\w+)( to )(\\\\w+)',\r\n    token: ['keyword', 'text', 'keyword', 'text', 'keyword', 'text'],\r\n  });\r\n}\r\n\r\nfunction rule_forRangeParen() {\r\n  return recognize('start', {\r\n    regex: '(' + _FOR + ' )(\\\\w+)( ' + _IN + ' ' + _RANGE + ')(\\\\()([\\\\s\\\\w]+)(,)([\\\\s\\\\w]+)(\\\\))',\r\n    token: ['keyword', 'text', 'keyword', 'paren.lparen', 'text', 'punctuation.operator', 'text', 'paren.rparen'],\r\n  });\r\n}\r\n\r\n/**\r\n * Modify the given ruleset, replacing literal spaces with \"one or more spaces\"\r\n */\r\nfunction loosenRules(rules: Rules) {\r\n  for (const ruleSets of Object.values(rules)) {\r\n    for (const rule of ruleSets) {\r\n      if (rule.regex && !(rule as any)._loosened) {\r\n        (rule as any).regex = rule.regex.replace(/ /g, ' +');\r\n        (rule as any)._loosened = true;\r\n      }\r\n    }\r\n  }\r\n  return rules;\r\n}\r\n\r\n\r\n\r\n// Only do this work if the 'define' function is actually available at runtime.\r\n// If not, this script got included on a page that didn't include the Ace\r\n// editor. No point in continuing if that is the case.\r\nif ((window as any).define) {\r\n\r\n  // Define the modes based on the level definitions above\r\n  for (const level of LEVELS) {\r\n\r\n    // This is a local definition of the file 'ace/mode/level1.js', etc.\r\n    define('ace/mode/' + level.name, [], function(require, exports, _module) {\r\n      var oop = require('ace/lib/oop');\r\n      var TextMode = require('ace/mode/text').Mode;\r\n      var TextHighlightRules = require('ace/mode/text_highlight_rules').TextHighlightRules;\r\n\r\n      function ThisLevelHighlightRules(this: any) {\r\n        this.$rules = loosenRules(level.rules);\r\n        this.normalizeRules();\r\n      };\r\n      oop.inherits(ThisLevelHighlightRules, TextHighlightRules);\r\n\r\n      function Mode(this: any) {\r\n        this.HighlightRules = ThisLevelHighlightRules;\r\n      };\r\n      oop.inherits(Mode, TextMode);\r\n\r\n      exports.Mode = Mode;\r\n    });\r\n  }\r\n}\r\n\r\n/**\r\n * Wrap a keyword in word-boundary markers for use in the tokenizer regexes\r\n *\r\n * Use this to only recognize a word if it's a complete word by itself (and\r\n * not accidentally a part of a larger word).\r\n *\r\n * The keyword must be followed by space.\r\n */\r\nfunction keywordWithSpace(keyword: string) {\r\n  return '\\\\b' + keyword + ' ';\r\n}\r\n", "import { modal, error } from './modal';\r\nimport { auth } from './auth';\r\n\r\nexport function create_class() {\r\n  modal.prompt (auth.texts['class_name_prompt'], '', function (class_name) {\r\n    if (!class_name) {\r\n      modal.alert(auth.texts['class_name_empty']);\r\n      return;\r\n    }\r\n    $.ajax({\r\n      type: 'POST',\r\n      url: '/class',\r\n      data: JSON.stringify({\r\n        name: class_name\r\n      }),\r\n      contentType: 'application/json',\r\n      dataType: 'json'\r\n    }).done(function(_response) {\r\n      location.reload ();\r\n    }).fail(function(err) {\r\n      if (err.responseText == \"duplicate\") {\r\n        modal.alert(auth.texts['class_name_duplicate']);\r\n        return;\r\n      }\r\n      console.error(err);\r\n      error.show(ErrorMessages['Connection_error'], JSON.stringify(err));\r\n    });\r\n  });\r\n}\r\n\r\nexport function rename_class(id: string) {\r\n  modal.prompt (auth.texts['class_name_prompt'], '', function (class_name) {\r\n    if (!class_name) {\r\n      modal.alert(auth.texts['class_name_empty']);\r\n      return;\r\n    }\r\n    $.ajax({\r\n      type: 'PUT',\r\n      url: '/class/' + id,\r\n      data: JSON.stringify({\r\n        name: class_name\r\n      }),\r\n      contentType: 'application/json',\r\n      dataType: 'json'\r\n    }).done(function(_response) {\r\n      location.reload ();\r\n    }).fail(function(err) {\r\n      if (err.responseText == \"duplicate\") {\r\n        modal.alert(auth.texts['class_name_duplicate']);\r\n        return;\r\n      }\r\n      console.error(err);\r\n      error.show(ErrorMessages['Connection_error'], JSON.stringify(err));\r\n    });\r\n  });\r\n}\r\n\r\nexport function delete_class(id: string) {\r\n  modal.confirm (auth.texts['delete_class_prompt'], function () {\r\n\r\n    $.ajax({\r\n      type: 'DELETE',\r\n      url: '/class/' + id,\r\n      contentType: 'application/json',\r\n      dataType: 'json'\r\n    }).done(function(_response) {\r\n      window.location.pathname = '/for-teachers';\r\n    }).fail(function(err) {\r\n      console.error(err);\r\n      error.show(ErrorMessages['Connection_error'], JSON.stringify(err));\r\n    });\r\n  });\r\n}\r\n\r\nexport function join_class(link: string, name: string, noRedirect=false) {\r\n  // If there's no session but we want to join the class, we store the program data in localStorage and redirect to /login.\r\n  if (! auth.profile) {\r\n    return modal.confirm (auth.texts['join_prompt'], function () {\r\n      localStorage.setItem ('hedy-join', JSON.stringify ({link: link, name: name}));\r\n      window.location.pathname = '/login';\r\n      return;\r\n    });\r\n  }\r\n\r\n  $.ajax({\r\n    type: 'GET',\r\n    url: link,\r\n  }).done(function(_response) {\r\n    modal.alert (auth.texts['class_join_confirmation'] + ' ' + name);\r\n    if (! noRedirect) window.location.pathname = '/programs';\r\n  }).fail(function(err) {\r\n    console.error(err);\r\n    error.show(ErrorMessages['Connection_error'], JSON.stringify(err));\r\n  });\r\n}\r\n\r\nexport function remove_student(class_id: string, student_id: string) {\r\n  modal.confirm (auth.texts['remove_student_prompt'], function () {\r\n\r\n    $.ajax({\r\n      type: 'DELETE',\r\n      url: '/class/' + class_id + '/student/' + student_id,\r\n      contentType: 'application/json',\r\n      dataType: 'json'\r\n    }).done(function(_response) {\r\n      location.reload ();\r\n    }).fail(function(err) {\r\n      console.error(err);\r\n      error.show(ErrorMessages['Connection_error'], JSON.stringify(err));\r\n    });\r\n  });\r\n}\r\n\r\nexport function save_level_settings(id: string, level: number) {\r\n     let selected_adventures: (string | null)[] = [];\r\n     $('#adventures_overview li').each(function() {\r\n         if ($(this).is(':visible') && $(this).find(':input').prop('checked')) {\r\n             selected_adventures.push(this.getAttribute('id'));\r\n         }\r\n     });\r\n\r\n     let progress = $('#progress'+ level).val();\r\n     let toggle_example_programs = false;\r\n     let toggle_level = false;\r\n     if ($('#hide_level' + level).prop('checked')) {\r\n       toggle_level = true;\r\n     }\r\n     if ($('#example_programs' + level).prop('checked')) {\r\n       toggle_example_programs = true;\r\n     }\r\n\r\n\r\n     $.ajax({\r\n       type: 'PUT',\r\n       url: '/customize-class/' + id,\r\n       data: JSON.stringify({\r\n         adventures: selected_adventures,\r\n         next_level: progress,\r\n         example_programs: toggle_example_programs,\r\n         hide_level: toggle_level,\r\n         level: level\r\n       }),\r\n       contentType: 'application/json',\r\n       dataType: 'json'\r\n     }).done(function(_response) {\r\n       location.reload ();\r\n     }).fail(function(err) {\r\n       console.error(err);\r\n       error.show(ErrorMessages['Connection_error'], JSON.stringify(err));\r\n     });\r\n }\r\n\r\n export  function reset_level_preferences(level: number) {\r\n     $('#adventures_overview li').each(function() {\r\n         if ($(this).is(':visible')) {\r\n             $(this).find(':input').prop(\"checked\", true);\r\n         }\r\n     });\r\n     $('#progress'+ level).val(5);\r\n     $('#example_programs' + level).prop(\"checked\", true);\r\n     $('#hide_level' + level).prop(\"checked\", false);\r\n }\r\n\r\n", "import { modal } from './modal';\r\nimport { join_class } from './teachers';\r\nimport { saveitP } from './app';\r\n\r\nconst countries: Record<string, string> = {'AF':'Afghanistan','AX':'\u00C5land Islands','AL':'Albania','DZ':'Algeria','AS':'American Samoa','AD':'Andorra','AO':'Angola','AI':'Anguilla','AQ':'Antarctica','AG':'Antigua and Barbuda','AR':'Argentina','AM':'Armenia','AW':'Aruba','AU':'Australia','AT':'Austria','AZ':'Azerbaijan','BS':'Bahamas','BH':'Bahrain','BD':'Bangladesh','BB':'Barbados','BY':'Belarus','BE':'Belgium','BZ':'Belize','BJ':'Benin','BM':'Bermuda','BT':'Bhutan','BO':'Bolivia, Plurinational State of','BQ':'Bonaire, Sint Eustatius and Saba','BA':'Bosnia and Herzegovina','BW':'Botswana','BV':'Bouvet Island','BR':'Brazil','IO':'British Indian Ocean Territory','BN':'Brunei Darussalam','BG':'Bulgaria','BF':'Burkina Faso','BI':'Burundi','KH':'Cambodia','CM':'Cameroon','CA':'Canada','CV':'Cape Verde','KY':'Cayman Islands','CF':'Central African Republic','TD':'Chad','CL':'Chile','CN':'China','CX':'Christmas Island','CC':'Cocos (Keeling) Islands','CO':'Colombia','KM':'Comoros','CG':'Congo','CD':'Congo, the Democratic Republic of the','CK':'Cook Islands','CR':'Costa Rica','CI':'C\u00F4te d\\'Ivoire','HR':'Croatia','CU':'Cuba','CW':'Cura\u00E7ao','CY':'Cyprus','CZ':'Czech Republic','DK':'Denmark','DJ':'Djibouti','DM':'Dominica','DO':'Dominican Republic','EC':'Ecuador','EG':'Egypt','SV':'El Salvador','GQ':'Equatorial Guinea','ER':'Eritrea','EE':'Estonia','ET':'Ethiopia','FK':'Falkland Islands (Malvinas)','FO':'Faroe Islands','FJ':'Fiji','FI':'Finland','FR':'France','GF':'French Guiana','PF':'French Polynesia','TF':'French Southern Territories','GA':'Gabon','GM':'Gambia','GE':'Georgia','DE':'Germany','GH':'Ghana','GI':'Gibraltar','GR':'Greece','GL':'Greenland','GD':'Grenada','GP':'Guadeloupe','GU':'Guam','GT':'Guatemala','GG':'Guernsey','GN':'Guinea','GW':'Guinea-Bissau','GY':'Guyana','HT':'Haiti','HM':'Heard Island and McDonald Islands','VA':'Holy See (Vatican City State)','HN':'Honduras','HK':'Hong Kong','HU':'Hungary','IS':'Iceland','IN':'India','ID':'Indonesia','IR':'Iran, Islamic Republic of','IQ':'Iraq','IE':'Ireland','IM':'Isle of Man','IL':'Israel','IT':'Italy','JM':'Jamaica','JP':'Japan','JE':'Jersey','JO':'Jordan','KZ':'Kazakhstan','KE':'Kenya','KI':'Kiribati','KP':'Korea, Democratic People\\'s Republic of','KR':'Korea, Republic of','KW':'Kuwait','KG':'Kyrgyzstan','LA':'Lao People\\'s Democratic Republic','LV':'Latvia','LB':'Lebanon','LS':'Lesotho','LR':'Liberia','LY':'Libya','LI':'Liechtenstein','LT':'Lithuania','LU':'Luxembourg','MO':'Macao','MK':'Macedonia, the Former Yugoslav Republic of','MG':'Madagascar','MW':'Malawi','MY':'Malaysia','MV':'Maldives','ML':'Mali','MT':'Malta','MH':'Marshall Islands','MQ':'Martinique','MR':'Mauritania','MU':'Mauritius','YT':'Mayotte','MX':'Mexico','FM':'Micronesia, Federated States of','MD':'Moldova, Republic of','MC':'Monaco','MN':'Mongolia','ME':'Montenegro','MS':'Montserrat','MA':'Morocco','MZ':'Mozambique','MM':'Myanmar','NA':'Namibia','NR':'Nauru','NP':'Nepal','NL':'Netherlands','NC':'New Caledonia','NZ':'New Zealand','NI':'Nicaragua','NE':'Niger','NG':'Nigeria','NU':'Niue','NF':'Norfolk Island','MP':'Northern Mariana Islands','NO':'Norway','OM':'Oman','PK':'Pakistan','PW':'Palau','PS':'Palestine, State of','PA':'Panama','PG':'Papua New Guinea','PY':'Paraguay','PE':'Peru','PH':'Philippines','PN':'Pitcairn','PL':'Poland','PT':'Portugal','PR':'Puerto Rico','QA':'Qatar','RE':'R\u00E9union','RO':'Romania','RU':'Russian Federation','RW':'Rwanda','BL':'Saint Barth\u00E9lemy','SH':'Saint Helena, Ascension and Tristan da Cunha','KN':'Saint Kitts and Nevis','LC':'Saint Lucia','MF':'Saint Martin (French part)','PM':'Saint Pierre and Miquelon','VC':'Saint Vincent and the Grenadines','WS':'Samoa','SM':'San Marino','ST':'Sao Tome and Principe','SA':'Saudi Arabia','SN':'Senegal','RS':'Serbia','SC':'Seychelles','SL':'Sierra Leone','SG':'Singapore','SX':'Sint Maarten (Dutch part)','SK':'Slovakia','SI':'Slovenia','SB':'Solomon Islands','SO':'Somalia','ZA':'South Africa','GS':'South Georgia and the South Sandwich Islands','SS':'South Sudan','ES':'Spain','LK':'Sri Lanka','SD':'Sudan','SR':'Suriname','SJ':'Svalbard and Jan Mayen','SZ':'Swaziland','SE':'Sweden','CH':'Switzerland','SY':'Syrian Arab Republic','TW':'Taiwan, Province of China','TJ':'Tajikistan','TZ':'Tanzania, United Republic of','TH':'Thailand','TL':'Timor-Leste','TG':'Togo','TK':'Tokelau','TO':'Tonga','TT':'Trinidad and Tobago','TN':'Tunisia','TR':'Turkey','TM':'Turkmenistan','TC':'Turks and Caicos Islands','TV':'Tuvalu','UG':'Uganda','UA':'Ukraine','AE':'United Arab Emirates','GB':'United Kingdom','US':'United States','UM':'United States Minor Outlying Islands','UY':'Uruguay','UZ':'Uzbekistan','VU':'Vanuatu','VE':'Venezuela, Bolivarian Republic of','VN':'Viet Nam','VG':'Virgin Islands, British','VI':'Virgin Islands, U.S.','WF':'Wallis and Futuna','EH':'Western Sahara','YE':'Yemen','ZM':'Zambia','ZW':'Zimbabwe'};\r\n\r\nexport interface Profile {\r\n  session_expires_at: number;\r\n}\r\n\r\ninterface User {\r\n  username?: string;\r\n  email?: string;\r\n  password?: string;\r\n  birth_year?: number;\r\n  country?: string;\r\n  gender?: string;\r\n  subscribe?: string;\r\n  prog_experience?: 'yes' | 'no';\r\n  experience_languages?: string[];\r\n  is_teacher?: string;\r\n}\r\n\r\ninterface UserForm {\r\n  username?: string;\r\n  email?: string;\r\n  password?: string;\r\n  birth_year?: string;\r\n  country?: string;\r\n  gender?: string;\r\n  subscribe?: string;\r\n  mail_repeat?: string;\r\n  password_repeat?: string;\r\n  old_password?: string;\r\n}\r\n\r\nif (!(window as any).AuthMessages) {\r\n  throw new Error('On a page where you load this JavaScript, you must also load the \"client_messages.js\" script');\r\n}\r\n\r\nexport const auth = {\r\n  texts: AuthMessages,\r\n  profile: undefined as (Profile | undefined),\r\n  reset: undefined as (Record<string, string> | undefined),\r\n  entityify: function (string: string) {\r\n      return string.replace (/&/g, '&amp;').replace (/</g, '&lt;').replace (/>/g, '&gt;').replace (/\"/g, '&quot;').replace (/'/g, '&#39;').replace (/`/g, '&#96;');\r\n   },\r\n  emailRegex: /^(([a-zA-Z0-9_+\\.\\-]+)@([\\da-zA-Z\\.\\-]+)\\.([a-zA-Z\\.]{2,6})\\s*)$/,\r\n  redirect: function (where: string) {\r\n    where = '/' + where;\r\n    window.location.pathname = where;\r\n  },\r\n  logout: function () {\r\n    $.ajax ({type: 'POST', url: '/auth/logout'}).done (function () {\r\n      auth.redirect ('login');\r\n    });\r\n  },\r\n  destroy: function () {\r\n    modal.confirm (auth.texts['are_you_sure'], function () {\r\n      $.ajax ({type: 'POST', url: '/auth/destroy'}).done (function () {\r\n        auth.redirect ('');\r\n      });\r\n    });\r\n  },\r\n  error: function (message: string, element?: string | null, id?: string) {\r\n    $ (id || '#error').html (message);\r\n    $ (id || '#error').css ('display', 'block');\r\n    if (element) $ ('#' + element).css ('border', 'solid 1px red');\r\n  },\r\n  clear_error: function (id?: string) {\r\n    $ (id || '#error').html ('');\r\n    $ (id || '#error').css ('display', 'none');\r\n    $ ('form *').css ('border', '');\r\n  },\r\n  success: function (message: string, id?: string) {\r\n    $ ('#error').css ('display', 'none');\r\n    $ (id || '#success').html (message);\r\n    $ (id || '#success').css ('display', 'block');\r\n  },\r\n  submit: function (op: string) {\r\n    const values: UserForm = {};\r\n    $ ('form.js-validated-form *').map (function (_k, el) {\r\n      if (el.id) values[el.id as keyof UserForm] = (el as HTMLInputElement).value;\r\n    });\r\n\r\n    if (op === 'signup') {\r\n      if (! values.username) return auth.error (auth.texts['please_username'], 'username');\r\n      values.username = values.username.trim ();\r\n      if (values.username.length < 3) return auth.error (auth.texts['username_three'], 'username');\r\n      if (values.username.match (/:|@/)) return auth.error (auth.texts['username_special'], 'username');\r\n\r\n      if (! values.email?.match (auth.emailRegex)) return auth.error (auth.texts['valid_email'], 'email');\r\n      if (values.email !== values.mail_repeat) return auth.error (auth.texts['repeat_match_email'],    'mail_repeat');\r\n\r\n      if (! values.password) return auth.error (auth.texts['please_password'], 'password');\r\n      if (values.password.length < 6) return auth.error (auth.texts['password_six'], 'password');\r\n      if (values.password !== values.password_repeat) return auth.error (auth.texts['repeat_match_password'], 'password_repeat');\r\n\r\n      if (values.birth_year) {\r\n        if (!validBirthYearString(values.birth_year)) {\r\n           return auth.error (auth.texts['valid_year'] + new Date ().getFullYear (), 'birth_year');\r\n        }\r\n      }\r\n\r\n      const payload: User = {\r\n        username: values.username,\r\n        email: values.email,\r\n        password: values.password,\r\n        birth_year: values.birth_year ? parseInt(values.birth_year) : undefined,\r\n        country: values.country ? values.country : undefined,\r\n        gender: values.gender ? values.gender : undefined,\r\n        subscribe: $('#subscribe').prop('checked'),\r\n        is_teacher: $('#is_teacher').prop('checked'),\r\n        prog_experience: $('input[name=has_experience]:checked').val() as 'yes'|'no',\r\n        experience_languages: $('#languages').is(':visible')\r\n          ? $('input[name=languages]').filter(':checked').map((_, box) => $(box).val() as string).get()\r\n          : undefined,\r\n      };\r\n\r\n      $.ajax ({type: 'POST', url: '/auth/signup', data: JSON.stringify (payload), contentType: 'application/json; charset=utf-8'}).done (function () {\r\n        auth.success (auth.texts['signup_success']);\r\n\r\n        // We set up a non-falsy profile to let `saveit` know that we're logged in. We put session_expires_at since we need it.\r\n        auth.profile = {session_expires_at: Date.now () + 1000 * 60 * 60 * 24};\r\n\r\n        afterLogin();\r\n      }).fail (function (response) {\r\n        const error = response.responseText || '';\r\n        if (error.match ('email'))         auth.error (auth.texts['exists_email']);\r\n        else if (error.match ('username')) auth.error (auth.texts['exists_username']);\r\n        else                               auth.error (auth.texts['ajax_error']);\r\n      });\r\n    }\r\n\r\n    if (op === 'login') {\r\n      if (! values.username) return auth.error (auth.texts['please_username_email'], 'username');\r\n      if (! values.password) return auth.error (auth.texts['please_password'], 'password');\r\n\r\n      auth.clear_error ();\r\n      $.ajax ({type: 'POST', url: '/auth/login', data: JSON.stringify ({username: values.username, password: values.password}), contentType: 'application/json; charset=utf-8'}).done (function () {\r\n\r\n        // We set up a non-falsy profile to let `saveit` know that we're logged in. We put session_expires_at since we need it.\r\n        auth.profile = {session_expires_at: Date.now () + 1000 * 60 * 60 * 24};\r\n\r\n        afterLogin();\r\n      }).fail (function (response) {\r\n        if (response.status === 403) {\r\n           auth.error (auth.texts['invalid_username_password'] + ' ' + auth.texts['no_account'] + ' &nbsp;<button class=\"green-btn\" onclick=\"auth.redirect (\\'signup\\')\">' + auth.texts['create_account'] + '</button>');\r\n           $ ('#create-account').hide ();\r\n           localStorage.setItem ('hedy-login-username', values.username ?? '');\r\n        }\r\n        else auth.error (auth.texts['ajax_error']);\r\n      });\r\n    }\r\n\r\n    if (op === 'profile') {\r\n      if (! (values.email ?? '').match (auth.emailRegex)) return auth.error (auth.texts['valid_email'], 'email');\r\n\r\n      if (values.birth_year) {\r\n        if (!validBirthYearString(values.birth_year)) {\r\n          return auth.error (auth.texts['valid_year'] + new Date ().getFullYear (), 'birth_year');\r\n        }\r\n      }\r\n\r\n      const payload: User = {\r\n        email: values['email'],\r\n        birth_year: values.birth_year ? parseInt(values['birth_year']) : undefined,\r\n        country: values['country'],\r\n        gender: values['gender'],\r\n        prog_experience: $ ('input[name=has_experience]:checked').val() as 'yes' | 'no',\r\n        experience_languages: $('#languages').is(':visible')\r\n          ? $('input[name=languages]').filter(':checked').map((_, box) => $(box).val() as string).get()\r\n          : undefined,\r\n      };\r\n\r\n      console.log(payload);\r\n\r\n      auth.clear_error ();\r\n      $.ajax ({type: 'POST', url: '/profile', data: JSON.stringify (payload), contentType: 'application/json; charset=utf-8'}).done (function () {\r\n        auth.success (auth.texts['profile_updated']);\r\n      }).fail (function (response) {\r\n        auth.error (auth.texts['ajax_error'] + ' ' + response.responseText);\r\n      });\r\n    }\r\n\r\n    if (op === 'change_password') {\r\n      if (! values.password) return auth.error (auth.texts['please_password'], 'password', '#error-password');\r\n      if (values.password.length < 6) return auth.error (auth.texts['password_six'], 'password', '#error-password');\r\n      if (values.password !== values.password_repeat) return auth.error (auth.texts['repeat_match'], 'password_repeat', '#error-password');\r\n\r\n      const payload = {old_password: values.old_password, new_password: values.password};\r\n\r\n      auth.clear_error ('#error-password');\r\n      $.ajax ({type: 'POST', url: '/auth/change_password', data: JSON.stringify (payload), contentType: 'application/json; charset=utf-8'}).done (function () {\r\n        auth.success (auth.texts['password_updated'], '#success-password');\r\n        $ ('#old_password').val ('');\r\n        $ ('#password').val ('');\r\n        $ ('#password_repeat').val ('');\r\n      }).fail (function (response) {\r\n        if (response.status === 403) auth.error (auth.texts['invalid_password'], null, '#error-password');\r\n        else                         auth.error (auth.texts['ajax_error'], null, '#error-password');\r\n      });\r\n    }\r\n\r\n    if (op === 'recover') {\r\n      if (! values.username) return auth.error (auth.texts['please_username'], 'username');\r\n\r\n      const payload = {username: values.username};\r\n\r\n      auth.clear_error ();\r\n      $.ajax ({type: 'POST', url: '/auth/recover', data: JSON.stringify (payload), contentType: 'application/json; charset=utf-8'}).done (function () {\r\n        auth.success (auth.texts['sent_password_recovery']);\r\n        $ ('#username').val ('');\r\n      }).fail (function (response) {\r\n        if (response.status === 403) auth.error (auth.texts['invalid_username']);\r\n        else                         auth.error (auth.texts['ajax_error']);\r\n      });\r\n    }\r\n\r\n    if (op === 'reset') {\r\n      if (! values.password) return auth.error (auth.texts['please_password'], 'password');\r\n      if (values.password.length < 6) return auth.error(auth.texts['password_six'], 'password');\r\n      if (values.password !== values.password_repeat) return auth.error (auth.texts['repeat_match'], 'password_repeat');\r\n\r\n      const payload = {username: auth.reset?.['username'], token: auth.reset?.['token'], password: values.password};\r\n\r\n      auth.clear_error ();\r\n      $.ajax ({type: 'POST', url: '/auth/reset', data: JSON.stringify (payload), contentType: 'application/json; charset=utf-8'}).done (function () {\r\n        auth.success (auth.texts['password_resetted']);\r\n        $ ('#password').val ('');\r\n        $ ('#password_repeat').val ('');\r\n        delete auth.reset;\r\n        auth.redirect ('login');\r\n      }).fail (function (response) {\r\n        if (response.status === 403) auth.error (auth.texts['invalid_reset_link']);\r\n        else                         auth.error (auth.texts['ajax_error']);\r\n      });\r\n    }\r\n  },\r\n  markAsTeacher: function (username: string, is_teacher: boolean) {\r\n    $.ajax ({type: 'POST', url: '/admin/markAsTeacher', data: JSON.stringify ({username: username, is_teacher: is_teacher}), contentType: 'application/json; charset=utf-8'}).done (function () {\r\n      modal.alert (['User', username, 'successfully', is_teacher ? 'marked' : 'unmarked', 'as teacher'].join (' '), 4000);\r\n      location.reload ();\r\n    }).fail (function (error) {\r\n      console.log (error);\r\n      modal.alert (['Error when', is_teacher ? 'marking' : 'unmarking', 'user', username, 'as teacher'].join (' '));\r\n    });\r\n  },\r\n\r\n  changeUserEmail: function (username: string, email: string) {\r\n    modal.prompt ('Please enter the corrected email', email, function (correctedEmail) {\r\n      if (correctedEmail === email) return;\r\n      if (! correctedEmail.match (auth.emailRegex)) return modal.alert ('Please enter a valid email.');\r\n      $.ajax ({type: 'POST', url: '/admin/changeUserEmail', data: JSON.stringify ({username: username, email: correctedEmail}), contentType: 'application/json; charset=utf-8'}).done (function () {\r\n        modal.alert (['Successfully changed the email for User', username, 'to', correctedEmail].join (' '));\r\n        location.reload ();\r\n      }).fail (function (error) {\r\n        console.log (error);\r\n        modal.alert (['Error when changing the email for User', username].join (' '));\r\n      });\r\n    });\r\n  },\r\n}\r\n\r\n// *** LOADERS ***\r\n\r\nif ($ ('#country')) {\r\n  let html = $('#country').html();\r\n  Object.keys (countries).map (function (code) {\r\n    html += '<option value=\"' + code + '\">' + countries [code] + '</option>';\r\n  });\r\n  $ ('#country').html (html);\r\n}\r\n\r\n$ ('.auth input').get ().map (function (el) {\r\n  // Clear red borders if input was marked from a previous error.\r\n  el.addEventListener ('input', () => auth.clear_error());\r\n});\r\n\r\n// We use GET /profile to see if we're logged in since we use HTTP only cookies and cannot check from javascript.\r\n$.ajax ({type: 'GET', url: '/profile'}).done (function (response) {\r\n  if (['/signup', '/login'].indexOf (window.location.pathname) !== -1) auth.redirect ('my-profile');\r\n\r\n  auth.profile = response;\r\n  if ($ ('#profile').html ()) {\r\n    $ ('#username').html (response.username);\r\n    $ ('#email').val (response.email);\r\n    $ ('#birth_year').val (response.birth_year);\r\n    $ ('#gender').val (response.gender);\r\n    $ ('#country').val (response.country);\r\n    if (response.prog_experience) {\r\n      $ ('input[name=has_experience][value=\"' + response.prog_experience + '\"]').prop ('checked', true);\r\n      if (response.prog_experience === 'yes') $ ('#languages').show ();\r\n    }\r\n    (response.experience_languages || []).map (function (lang: string) {\r\n       $ ('input[name=languages][value=\"' + lang + '\"]').prop ('checked', true);\r\n    });\r\n    if (! jQuery.isEmptyObject(response.student_classes)) {\r\n      $ ('#student_classes ul').html ((response.student_classes || []).map (function (Class: Class) {\r\n        return '<li>' + auth.entityify (Class.name) + '</li>';\r\n      }).join (''));\r\n    } else {\r\n      $ ('#student_classes').hide();\r\n    }\r\n  }\r\n}).fail (function (_response) {\r\n  if (window.location.pathname.indexOf ('/my-profile') !== -1) auth.redirect ('login');\r\n});\r\n\r\nif (window.location.pathname === '/reset') {\r\n  const query = window.location.search.slice (1).split ('&');\r\n  const params: Record<string, string> = {};\r\n  query.map (function (item) {\r\n    const split = item.split ('=');\r\n    params [split [0]] = decodeURIComponent (split [1]);\r\n  });\r\n  // If we don't receive username and token, the redirect link is invalid. We redirect the user to /recover.\r\n  if (! params['username'] || ! params['token']) auth.redirect ('recover')\r\n  else auth.reset = params;\r\n}\r\n\r\nif (window.location.pathname === '/signup') {\r\n  const login_username = localStorage.getItem ('hedy-login-username');\r\n  if (login_username) {\r\n    localStorage.removeItem ('hedy-login-username');\r\n    if (login_username.match ('@')) $ ('#email').val (login_username);\r\n    else                            $ ('#username').val (login_username);\r\n  }\r\n}\r\n\r\n$ ('#email, #mail_repeat').on ('cut copy paste', function (e) {\r\n   e.preventDefault ();\r\n   return false;\r\n});\r\n\r\ninterface Class {\r\n  name: string;\r\n}\r\n\r\n/**\r\n * After login:\r\n *\r\n * - Check if there's a saved program in localstorage. If so, save it.\r\n * - Check if we were supposed to be joining a class. If so, join it.\r\n * - Otherwise redirect to \"my programs\".\r\n */\r\nasync function afterLogin() {\r\n  const savedProgramString = localStorage.getItem('hedy-first-save');\r\n  const savedProgram = savedProgramString ? JSON.parse(savedProgramString) : undefined;\r\n\r\n  if (savedProgram) {\r\n    await saveitP(savedProgram[0], savedProgram[1], savedProgram[2], savedProgram[3]);\r\n    localStorage.removeItem('hedy-first-save');\r\n\r\n    const redirect = getSavedRedirectPath();\r\n    if (redirect) {\r\n      return auth.redirect(redirect);\r\n    }\r\n  }\r\n\r\n  const joinClassString = localStorage.getItem('hedy-join');\r\n  const joinClass = joinClassString ? JSON.parse(joinClassString) : undefined;\r\n  if (joinClass) {\r\n    localStorage.removeItem('hedy-join');\r\n    return join_class(joinClass.link, joinClass.name);\r\n  }\r\n\r\n  const redirect = getSavedRedirectPath();\r\n  if (redirect) {\r\n    return auth.redirect(redirect);\r\n  }\r\n\r\n  auth.redirect('programs');\r\n}\r\n\r\nfunction getSavedRedirectPath() {\r\n  const redirect = localStorage.getItem('hedy-save-redirect');\r\n  if (redirect) {\r\n    localStorage.removeItem('hedy-save-redirect');\r\n  }\r\n  return redirect;\r\n}\r\n\r\nfunction validBirthYearString(year: string) {\r\n  const birth_year = parseInt (year);\r\n  if (! birth_year || birth_year < 1900 || birth_year > new Date ().getFullYear ()) return false;\r\n  return true;\r\n}\r\n", "// It's important that this file gets loaded first\r\nimport './syntaxModesRules';\r\n\r\nimport { modal, error, success } from './modal';\r\nimport { auth } from './auth';\r\n\r\nexport let theGlobalEditor: AceAjax.Editor;\r\n\r\n(function() {\r\n  // A bunch of code expects a global \"State\" object. Set it here if not\r\n  // set yet.\r\n  if (!window.State) {\r\n    window.State = {};\r\n  }\r\n\r\n  // *** EDITOR SETUP ***\r\n  initializeMainEditor($('#editor'));\r\n\r\n  // Any code blocks we find inside 'turn-pre-into-ace' get turned into\r\n  // read-only editors (for syntax highlighting)\r\n  for (const preview of $('.turn-pre-into-ace pre').get()) {\r\n    $(preview).addClass('text-lg rounded');\r\n    const exampleEditor = turnIntoAceEditor(preview, true)\r\n    // Fits to content size\r\n    exampleEditor.setOptions({ maxLines: Infinity });\r\n    exampleEditor.setOptions({ minLines: 2 });\r\n    // Strip trailing newline, it renders better\r\n    exampleEditor.setValue(exampleEditor.getValue().replace(/\\n+$/, ''), -1);\r\n    // And add an overlay button to the editor, if the no-copy-button attribute isn't there\r\n    if (! $(preview).hasClass('no-copy-button')) {\r\n      const buttonContainer = $('<div>').css({ position: 'absolute', top: 5, right: 5, width: 'auto' }).appendTo(preview);\r\n      $('<button>').attr('title', UiMessages['try_button']).css({ fontFamily: 'sans-serif' }).addClass('green-btn').text('\u21E5').appendTo(buttonContainer).click(function() {\r\n        theGlobalEditor?.setValue(exampleEditor.getValue() + '\\n');\r\n      });\r\n    } else {\r\n      if($(preview).attr('id')){\r\n        // @ts-ignore\r\n        let level = String($(preview).attr('id'));\r\n        const mode = getHighlighter(parseInt(level));\r\n        exampleEditor.session.setMode(mode);\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Initialize the main editor and attach all the required event handlers\r\n   */\r\n  function initializeMainEditor($editor: JQuery) {\r\n    if (!$editor.length) return;\r\n\r\n    // We expose the editor globally so it's available to other functions for resizing\r\n    var editor = turnIntoAceEditor($editor.get(0)!, $editor.data('readonly'));\r\n    theGlobalEditor = editor;\r\n    error.setEditor(editor);\r\n\r\n    window.Range = ace.require('ace/range').Range // get reference to ace/range\r\n\r\n    // Load existing code from session, if it exists\r\n    const storage = window.sessionStorage;\r\n    if (storage) {\r\n      const levelKey = $editor.data('lskey');\r\n      const loadedProgram = $editor.data('loaded-program');\r\n\r\n      // On page load, if we have a saved program and we are not loading a program by id, we load the saved program\r\n      const programFromStorage = storage.getItem(levelKey);\r\n      if (loadedProgram !== 'True' && programFromStorage) {\r\n        editor.setValue(programFromStorage, 1);\r\n      }\r\n\r\n      // When the user exits the editor, save what we have.\r\n      editor.on('blur', function(_e: Event) {\r\n        storage.setItem(levelKey, editor.getValue());\r\n      });\r\n\r\n      // If prompt is shown and user enters text in the editor, hide the prompt.\r\n      editor.on('change', function () {\r\n        if ($('#inline-modal').is (':visible')) $('#inline-modal').hide();\r\n        window.State.disable_run = false;\r\n        $ ('#runit').css('background-color', '');\r\n        window.State.unsaved_changes = true;\r\n\r\n        clearErrors(editor);\r\n      });\r\n    }\r\n\r\n    // *** PROMPT TO SAVE CHANGES ***\r\n\r\n    window.onbeforeunload = () => {\r\n      // The browser doesn't show this message, rather it shows a default message.\r\n      if (window.State.unsaved_changes && !window.State.no_unload_prompt) {\r\n        return auth.texts['unsaved_changes'];\r\n      } else {\r\n        return undefined;\r\n      }\r\n    };\r\n\r\n    // *** KEYBOARD SHORTCUTS ***\r\n\r\n    let altPressed: boolean | undefined;\r\n\r\n    // alt is 18, enter is 13\r\n    window.addEventListener ('keydown', function (ev) {\r\n      const keyCode = ev.keyCode;\r\n      if (keyCode === 18) {\r\n        altPressed = true;\r\n        return;\r\n      }\r\n      if (keyCode === 13 && altPressed) {\r\n        if (!window.State.level || !window.State.lang) {\r\n          throw new Error('Oh no');\r\n        }\r\n        runit (window.State.level, window.State.lang, function () {\r\n          $ ('#output').focus ();\r\n        });\r\n      }\r\n      // We don't use jquery because it doesn't return true for this equality check.\r\n      if (keyCode === 37 && document.activeElement === document.getElementById ('output')) {\r\n        editor.focus ();\r\n        editor.navigateFileEnd ();\r\n      }\r\n    });\r\n    window.addEventListener ('keyup', function (ev) {\r\n      const keyCode = ev.keyCode;\r\n      if (keyCode === 18) {\r\n        altPressed = false;\r\n        return;\r\n      }\r\n    });\r\n    return editor;\r\n  }\r\n\r\n  /**\r\n   * Turn an HTML element into an Ace editor\r\n   */\r\n  function turnIntoAceEditor(element: HTMLElement, isReadOnly: boolean): AceAjax.Editor {\r\n    const editor = ace.edit(element);\r\n    editor.setTheme(\"ace/theme/monokai\");\r\n    if (isReadOnly) {\r\n      editor.setOptions({\r\n        readOnly: true,\r\n        showGutter: false,\r\n        showPrintMargin: false,\r\n        highlightActiveLine: false\r\n      });\r\n    }\r\n\r\n    // a variable which turns on(1) highlighter or turns it off(0)\r\n    var highlighter = 1;\r\n\r\n    if (highlighter == 1) {\r\n      // Everything turns into 'ace/mode/levelX', except what's in\r\n      // this table. Yes the numbers are strings. That's just JavaScript for you.\r\n      if (window.State.level) {\r\n        const mode = getHighlighter(parseInt(window.State.level));\r\n        editor.session.setMode(mode);\r\n      }\r\n    }\r\n\r\n    return editor;\r\n  }\r\n})();\r\n\r\nfunction getHighlighter(level: number) {\r\n  const modeExceptions: Record<string, string> = {\r\n        '9': 'ace/mode/level9and10',\r\n        '10': 'ace/mode/level9and10',\r\n        '18': 'ace/mode/level18and19',\r\n        '19': 'ace/mode/level18and19',\r\n      };\r\n  return modeExceptions[level] || `ace/mode/level` + level;\r\n}\r\n\r\nfunction reloadOnExpiredSession () {\r\n   // If user is not logged in or session is not expired, return false.\r\n   if (! auth.profile || auth.profile.session_expires_at > Date.now ()) return false;\r\n   // Otherwise, reload the page to update the top bar.\r\n   location.reload ();\r\n   return true;\r\n}\r\n\r\nfunction clearErrors(editor: AceAjax.Editor) {\r\n  editor.session.clearAnnotations();\r\n  for (const marker in editor.session.getMarkers(false)) {\r\n    editor.session.removeMarker(marker as any);\r\n  }\r\n}\r\n\r\nexport function runit(level: string, lang: string, cb: () => void) {\r\n  if (window.State.disable_run) return modal.alert (auth.texts['answer_question']);\r\n\r\n  if (reloadOnExpiredSession ()) return;\r\n\r\n  error.hide();\r\n  success.hide();\r\n  try {\r\n    level = level.toString();\r\n    var editor = theGlobalEditor;\r\n    var code = get_trimmed_code();\r\n\r\n    clearErrors(editor);\r\n\r\n    console.log('Original program:\\n', code);\r\n    $.ajax({\r\n      type: 'POST',\r\n      url: '/parse',\r\n      data: JSON.stringify({\r\n        level: level,\r\n        code: code,\r\n        lang: lang,\r\n        read_aloud : !!$('#speak_dropdown').val(),\r\n        adventure_name: window.State.adventure_name\r\n      }),\r\n      contentType: 'application/json',\r\n      dataType: 'json'\r\n    }).done(function(response: any) {\r\n      console.log('Response', response);\r\n      if (response.Warning) {\r\n        error.showWarning(ErrorMessages['Transpile_warning'], response.Warning);\r\n      }\r\n      if (response.Error) {\r\n        error.show(ErrorMessages['Transpile_error'], response.Error);\r\n        if (response.Location && response.Location[0] != \"?\") {\r\n          // Location can be either [row, col] or just [row].\r\n\r\n          highlightAceError(editor, response.Location[0], response.Location[1]);\r\n        }\r\n        return;\r\n      }\r\n      if (response.Code){\r\n        console.log(\"success!\");\r\n        var allsuccessmessages = ErrorMessages['Transpile_success'];\r\n        var randomnum: number = Math.floor(Math.random() * allsuccessmessages.length);\r\n        success.show(allsuccessmessages[randomnum]);\r\n      }\r\n      runPythonProgram(response.Code, response.has_turtle, cb).catch(function(err) {\r\n        console.log(err)\r\n        error.show(ErrorMessages['Execute_error'], err.message);\r\n        reportClientError(level, code, err.message);\r\n      });\r\n    }).fail(function(xhr) {\r\n      console.error(xhr);\r\n      // https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest/readyState\r\n      if (xhr.readyState < 4) {\r\n        error.show(ErrorMessages['Connection_error'], ErrorMessages['CheckInternet']);\r\n      } else {\r\n        error.show(ErrorMessages['Other_error'], ErrorMessages['ServerError']);\r\n      }\r\n    });\r\n\r\n  } catch (e: any) {\r\n    console.error(e);\r\n    error.show(ErrorMessages['Other_error'], e.message);\r\n  }\r\n}\r\n\r\n/**\r\n * Mark an error location in the ace editor\r\n *\r\n * The error occurs at the given row, and optionally has a column and\r\n * and a length.\r\n *\r\n * If 'col' is not given, the entire line will be highlighted red. Otherwise\r\n * the character at 'col' will be highlighted, optionally extending for\r\n * 'length' characters.\r\n *\r\n * 'row' and 'col' are 1-based.\r\n */\r\nfunction highlightAceError(editor: AceAjax.Editor, row: number, col?: number, length=1) {\r\n  // This adds a red cross in the left margin.\r\n  // Not sure what the \"column\" argument does here -- it doesn't seem\r\n  // to make a difference.\r\n  editor.session.setAnnotations([\r\n    {\r\n      row: row - 1,\r\n      column: (col ?? 1) - 1,\r\n      text: '',\r\n      type: 'error',\r\n    }\r\n  ]);\r\n\r\n  if (col === undefined) {\r\n    // Higlight entire row\r\n    editor.session.addMarker(\r\n      new ace.Range(row - 1, 1, row - 1, 2),\r\n      \"editor-error\", \"fullLine\", false\r\n    );\r\n    return;\r\n  }\r\n\r\n  // Highlight span\r\n  editor.session.addMarker(\r\n    new ace.Range(\r\n      row - 1, col - 1,\r\n      row - 1, col - 1 + length,\r\n    ),\r\n    \"editor-error\", \"text\", false\r\n  );\r\n}\r\n\r\n/**\r\n * Called when the user clicks the \"Try\" button in one of the palette buttons\r\n */\r\nexport function tryPaletteCode(exampleCode: string) {\r\n  if (auth.profile) {\r\n    if (window.State.examples_left > 0) {\r\n      window.State.examples_left = window.State.examples_left - 1;\r\n    } else {\r\n      $(\"#commands-window\").hide();\r\n      $(\"#toggle-button\").hide();\r\n      modal.alert(auth.texts['examples_used']);\r\n      return;\r\n    }\r\n  }\r\n  var editor = ace.edit(\"editor\");\r\n\r\n  var MOVE_CURSOR_TO_END = 1;\r\n  editor.setValue(exampleCode + '\\n', MOVE_CURSOR_TO_END);\r\n  window.State.unsaved_changes = false;\r\n}\r\n\r\nexport function saveit(level: number | [number, string], lang: string, name: string, code: string, cb?: (err: any, resp?: any) => void) {\r\n  error.hide();\r\n  success.hide();\r\n\r\n  if (reloadOnExpiredSession ()) return;\r\n\r\n  try {\r\n    // If there's no session but we want to save the program, we store the program data in localStorage and redirect to /login.\r\n    if (! auth.profile) {\r\n       return modal.confirm (auth.texts['save_prompt'], function () {\r\n         // If there's an adventure_name, we store it together with the level, because it won't be available otherwise after signup/login.\r\n         if (window.State && window.State.adventure_name && !Array.isArray(level)) level = [level, window.State.adventure_name];\r\n         localStorage.setItem ('hedy-first-save', JSON.stringify ([level, lang, name, code]));\r\n         window.location.pathname = '/login';\r\n       });\r\n    }\r\n\r\n    window.State.unsaved_changes = false;\r\n\r\n    var adventure_name = window.State.adventure_name;\r\n    // If saving a program for an adventure after a signup/login, level is an array of the form [level, adventure_name]. In that case, we unpack it.\r\n    if (Array.isArray(level)) {\r\n       adventure_name = level [1];\r\n       level = level [0];\r\n    }\r\n\r\n    $.ajax({\r\n      type: 'POST',\r\n      url: '/programs',\r\n      data: JSON.stringify({\r\n        level: level,\r\n        lang:  lang,\r\n        name:  name,\r\n        code:  code,\r\n        adventure_name: adventure_name\r\n      }),\r\n      contentType: 'application/json',\r\n      dataType: 'json'\r\n    }).done(function(response) {\r\n      // The auth functions use this callback function.\r\n      if (cb) return response.Error ? cb (response) : cb (null, response);\r\n      if (response.Warning) {\r\n        error.showWarning(ErrorMessages['Transpile_warning'], response.Warning);\r\n      }\r\n      if (response.Error) {\r\n        error.show(ErrorMessages['Transpile_error'], response.Error);\r\n        return;\r\n      }\r\n      modal.alert (auth.texts['save_success_detail'], 4000);\r\n      // If we succeed, we need to update the default program name & program for the currently selected tab.\r\n      // To avoid this, we'd have to perform a page refresh to retrieve the info from the server again, which would be more cumbersome.\r\n      // The name of the program might have been changed by the server, so we use the name stated by the server.\r\n      $ ('#program_name').val (response.name);\r\n      window.State.adventures?.map (function (adventure) {\r\n        if (adventure.short_name === (adventure_name || 'level')) {\r\n          adventure.loaded_program = {name: response.name, code: code};\r\n        }\r\n      });\r\n    }).fail(function(err) {\r\n      console.error(err);\r\n      error.show(ErrorMessages['Connection_error'], JSON.stringify(err));\r\n      if (err.status === 403) {\r\n         localStorage.setItem ('hedy-first-save', JSON.stringify ([adventure_name ? [level, adventure_name] : level, lang, name, code]));\r\n         localStorage.setItem ('hedy-save-redirect', 'hedy');\r\n         window.location.pathname = '/login';\r\n      }\r\n    });\r\n  } catch (e: any) {\r\n    console.error(e);\r\n    error.show(ErrorMessages['Other_error'], e.message);\r\n  }\r\n}\r\n\r\n/**\r\n * The 'saveit' function, as an async function\r\n */\r\nexport function saveitP(level: number | [number, string], lang: string, name: string, code: string) {\r\n  return new Promise<any>((ok, ko) => {\r\n    saveit(level, lang, name, code, (err, response) => {\r\n      if (err) {\r\n        ko(err);\r\n      } else {\r\n        ok(response);\r\n      }\r\n    });\r\n  });\r\n}\r\n\r\nexport function viewProgramLink(programId: string) {\r\n  return window.location.origin + '/hedy/' + programId + '/view';\r\n}\r\n\r\nexport function share_program (level: number, lang: string, id: string | true, Public: boolean, reload?: boolean) {\r\n  if (! auth.profile) return modal.alert (auth.texts['must_be_logged']);\r\n\r\n  var share = function (id: string) {\r\n    $.ajax({\r\n      type: 'POST',\r\n      url: '/programs/share',\r\n      data: JSON.stringify({\r\n        id: id,\r\n        public: Public\r\n      }),\r\n      contentType: 'application/json',\r\n      dataType: 'json'\r\n    }).done(function(_response) {\r\n      // If we're sharing the program, copy the link to the clipboard.\r\n      if (Public) copy_to_clipboard (viewProgramLink(id), true);\r\n      modal.alert (Public ? auth.texts['share_success_detail'] : auth.texts['unshare_success_detail'], 4000);\r\n      if (reload) setTimeout (function () {location.reload ()}, 1000);\r\n    }).fail(function(err) {\r\n      console.error(err);\r\n      error.show(ErrorMessages['Connection_error'], JSON.stringify(err));\r\n    });\r\n  }\r\n\r\n  // If id is not true, the request comes from the programs page. In that case, we merely call the share function.\r\n  if (id !== true) return share (id);\r\n\r\n  // Otherwise, we save the program and then share it.\r\n  // Saving the program makes things way simpler for many reasons: it covers the cases where:\r\n  // 1) there's no saved program; 2) there's no saved program for that user; 3) the program has unsaved changes.\r\n  const name = `${$('#program_name').val()}`;\r\n  const code = get_trimmed_code();\r\n  return saveit(level, lang, name, code, (err: any, resp: any) => {\r\n      if (err && err.Warning)\r\n        return error.showWarning(ErrorMessages['Transpile_warning'], err.Warning);\r\n      if (err && err.Error)\r\n        return error.show(ErrorMessages['Transpile_error'], err.Error);\r\n      share(resp.id);\r\n    });\r\n\r\n}\r\n\r\nexport function copy_to_clipboard (string: string, noAlert: boolean) {\r\n  // https://hackernoon.com/copying-text-to-clipboard-with-javascript-df4d4988697f\r\n  var el = document.createElement ('textarea');\r\n  el.value = string;\r\n  el.setAttribute ('readonly', '');\r\n  el.style.position = 'absolute';\r\n  el.style.left = '-9999px';\r\n  document.body.appendChild (el);\r\n\r\n  const selection = document.getSelection();\r\n  const originalSelection = selection && selection.rangeCount > 0 ? selection.getRangeAt(0) : undefined;\r\n\r\n  el.select ();\r\n  document.execCommand ('copy');\r\n  document.body.removeChild (el);\r\n  if (originalSelection) {\r\n     document.getSelection()?.removeAllRanges ();\r\n     document.getSelection()?.addRange (originalSelection);\r\n  }\r\n  if (! noAlert) modal.alert (auth.texts['copy_clipboard'], 4000);\r\n}\r\n\r\n/**\r\n * Do a POST with the error to the server so we can log it\r\n */\r\nfunction reportClientError(level: string, code: string, client_error: string) {\r\n  $.ajax({\r\n    type: 'POST',\r\n    url: '/report_error',\r\n    data: JSON.stringify({\r\n      level: level,\r\n      code: code,\r\n      page: window.location.href,\r\n      client_error: client_error,\r\n    }),\r\n    contentType: 'application/json',\r\n    dataType: 'json'\r\n  });\r\n}\r\n\r\nwindow.onerror = function reportClientException(message, source, line_number, column_number, error) {\r\n\r\n  $.ajax({\r\n    type: 'POST',\r\n    url: '/client_exception',\r\n    data: JSON.stringify({\r\n      message: message,\r\n      source: source,\r\n      line_number: line_number,\r\n      column_number: column_number,\r\n      error: error,\r\n      url: window.location.href,\r\n      user_agent: navigator.userAgent,\r\n    }),\r\n    contentType: 'application/json',\r\n    dataType: 'json'\r\n  });\r\n}\r\n\r\nfunction runPythonProgram(code: string, hasTurtle: boolean, cb: () => void) {\r\n\r\n  // We keep track of how many programs are being run at the same time to avoid prints from multiple simultaneous programs.\r\n  // Please see note at the top of the `outf` function.\r\n  if (! window.State.programsInExecution) window.State.programsInExecution = 0;\r\n  window.State.programsInExecution++;\r\n\r\n  const outputDiv = $('#output');\r\n  outputDiv.empty();\r\n\r\n  Sk.pre = \"output\";\r\n  const turtleConfig = (Sk.TurtleGraphics || (Sk.TurtleGraphics = {}));\r\n  turtleConfig.target = 'turtlecanvas';\r\n  if ($('#adventures').is(\":hidden\")) {\r\n      turtleConfig.height = 600;\r\n      turtleConfig.worldHeight = 600;\r\n  } else {\r\n      turtleConfig.height = 300;\r\n      turtleConfig.worldHeight = 300;\r\n  }\r\n  turtleConfig.width = 400;\r\n  turtleConfig.worldWidth = 400;\r\n\r\n  if (!hasTurtle) {\r\n    // There might still be a visible turtle panel. If the new program does not use the Turtle,\r\n    // remove it (by clearing the '#turtlecanvas' div)\r\n    $('#turtlecanvas').empty();\r\n  }\r\n\r\n  Sk.configure({\r\n    output: outf,\r\n    read: builtinRead,\r\n    inputfun: inputFromInlineModal,\r\n    inputfunTakesPrompt: true,\r\n    __future__: Sk.python3,\r\n    timeoutMsg: function () {return ErrorMessages ['Program_too_long']},\r\n    // Give up after three seconds of execution, there might be an infinite loop.\r\n    // This function can be customized later to yield different timeouts for different levels.\r\n    execLimit: (function () {\r\n      // const level = window.State.level;\r\n      return ((hasTurtle) ? 20000 : 3000);\r\n    }) ()\r\n  });\r\n\r\n  return Sk.misceval.asyncToPromise(function () {\r\n    return Sk.importMainWithBody(\"<stdin>\", false, code, true);\r\n  }).then(function(_mod) {\r\n    console.log('Program executed');\r\n    // Check if the program was correct but the output window is empty: Return a warning\r\n    if (window.State.programsInExecution === 1 && $('#output').is(':empty') && $('#turtlecanvas').is(':empty')) {\r\n      error.showWarning(ErrorMessages['Transpile_warning'], ErrorMessages['Empty_output']);\r\n    }\r\n    window.State.programsInExecution--;\r\n    if (cb) cb ();\r\n  }).catch(function(err) {\r\n    // Extract error message from error\r\n    console.log(err);\r\n    const errorMessage = errorMessageFromSkulptError(err) || JSON.stringify(err);\r\n    throw new Error(errorMessage);\r\n  });\r\n\r\n  /**\r\n   * Get the error messages from a Skulpt error\r\n   *\r\n   * They look like this:\r\n   *\r\n   * {\"args\":{\"v\":[{\"v\":\"name 'name' is not defined\"}]},\"traceback\":[{\"lineno\":3,\"colno\":0,\"filename\":\"<stdin>.py\"}]}\r\n   *\r\n   * Don't know why, so let's be defensive about it.\r\n   */\r\n  function errorMessageFromSkulptError(err: any) {\r\n    const message = err.args && err.args.v && err.args.v[0] && err.args.v[0].v;\r\n    return message;\r\n  }\r\n\r\n  function addToOutput(text: string, color: string) {\r\n    $('<span>').text(text).css({ color }).appendTo(outputDiv);\r\n  }\r\n\r\n  // output functions are configurable.  This one just appends some text\r\n  // to a pre element.\r\n  function outf(text: string) {\r\n    // If there's more than one program being executed at a time, we ignore it.\r\n    // This happens when a program requiring user input is suspended when the user changes the code.\r\n    if (window.State.programsInExecution > 1) return;\r\n    addToOutput(text, 'white');\r\n    speak(text)\r\n  }\r\n\r\n  function builtinRead(x: string) {\r\n    if (Sk.builtinFiles === undefined || Sk.builtinFiles[\"files\"][x] === undefined)\r\n        throw \"File not found: '\" + x + \"'\";\r\n    return Sk.builtinFiles[\"files\"][x];\r\n  }\r\n\r\n  // This method draws the prompt for asking for user input.\r\n  function inputFromInlineModal(prompt: string) {\r\n    // We give the user time to give input.\r\n    Sk.execStart = new Date (new Date ().getTime () + 1000 * 60 * 60 * 24 * 365);\r\n    $('#turtlecanvas').empty();\r\n    return new Promise(function(ok) {\r\n\r\n      window.State.disable_run = true;\r\n      $ ('#runit').css('background-color', 'gray');\r\n\r\n      const input = $('#inline-modal input[type=\"text\"]');\r\n      $('#inline-modal .caption').text(prompt);\r\n      input.val('');\r\n      input.attr('placeholder', prompt);\r\n      speak(prompt)\r\n\r\n      setTimeout(function() {\r\n        input.focus();\r\n      }, 0);\r\n      $('#inline-modal form').one('submit', function(event) {\r\n\r\n        window.State.disable_run = false;\r\n        $ ('#runit').css('background-color', '');\r\n\r\n        event.preventDefault();\r\n        $('#inline-modal').hide();\r\n        // We reset the timer to the present moment.\r\n        Sk.execStart = new Date ();\r\n        // We set a timeout for sending back the input, so that the input box is hidden before processing the program.\r\n        // Since processing the program might take some time, this timeout increases the responsiveness of the UI after\r\n        // replying to a query.\r\n        setTimeout (function () {\r\n           ok(input.val());\r\n           $ ('#output').focus ();\r\n        }, 0);\r\n\r\n        return false;\r\n      });\r\n      $('#inline-modal').show();\r\n    });\r\n  }\r\n}\r\n\r\nfunction speak(text: string) {\r\n  var selectedURI = $('#speak_dropdown').val();\r\n  if (!selectedURI) { return; }\r\n  var voice = window.speechSynthesis.getVoices().filter(v => v.voiceURI === selectedURI)[0];\r\n\r\n  if (voice) {\r\n    let utterance = new SpeechSynthesisUtterance(text);\r\n    utterance.voice = voice;\r\n    utterance.rate = 0.9;\r\n    speechSynthesis.speak(utterance);\r\n  }\r\n}\r\n\r\n(() => {\r\n  if (!window.speechSynthesis) { return; /* No point in even trying */ }\r\n  if (!window.State.lang) { return; /* Not on a code page */ }\r\n\r\n  /**\r\n   * Show the \"speak\" checkbox if we find that we have speech support for the\r\n   * current language (showing an initially hidden element is a better experience\r\n   * than hiding an initially shown element... arguably... ?)\r\n   *\r\n   * Also, for funzies: the speechSynthesis.getVoices() array is asynchronously\r\n   * populated *some time* after the page loads... and we won't know when. Keep\r\n   * on testing periodically until we got it or it's taken too long to finish.\r\n   */\r\n  let attempts = 0;\r\n  const timer = setInterval(function() {\r\n    attempts += 1;\r\n\r\n    const voices = findVoices(window.State.lang ?? '');\r\n\r\n    if (voices.length > 0) {\r\n      for (const voice of voices) {\r\n        $('#speak_dropdown').append($('<option>').attr('value', voice.voiceURI).text('\uD83D\uDCE3 ' + voice.name));\r\n      }\r\n\r\n      $('#speak_container').show();\r\n\r\n      clearInterval(timer);\r\n    }\r\n    if (attempts >= 20) {  // ~2 seconds\r\n      // Give up\r\n      clearInterval(timer);\r\n    }\r\n  }, 100);\r\n\r\n  function findVoices(lang: string) {\r\n    // Our own \"lang\" is *typically* just the language code, but we also have \"pt_BR\".\r\n    const m = lang.match(/^([a-z]+)/i);\r\n    if (!m) { return []; }\r\n    const simpleLang = m[1];\r\n\r\n    // If the feature doesn't exist in the browser, return null\r\n    if (!window.speechSynthesis) { return []; }\r\n    return window.speechSynthesis.getVoices().filter(voice => voice.lang.startsWith(simpleLang));\r\n  }\r\n})();\r\n\r\nexport function prompt_unsaved(cb: () => void) {\r\n  // This variable avoids showing the generic native `onbeforeunload` prompt\r\n  window.State.no_unload_prompt = true;\r\n  if (! window.State.unsaved_changes || ! auth.profile) return cb ();\r\n  modal.confirm(auth.texts['unsaved_changes'], cb);\r\n}\r\n\r\nexport function load_quiz(level: string) {\r\n  $('*[data-tabtarget=\"end\"]').html ('<iframe id=\"quiz-iframe\" class=\"w-full\" title=\"Quiz\" src=\"/quiz/start/' + level + '\"></iframe>');\r\n}\r\n\r\nexport function get_trimmed_code() {\r\n  try {\r\n    // This module may or may not exist, so let's be extra careful here.\r\n    const whitespace = ace.require(\"ace/ext/whitespace\");\r\n    whitespace.trimTrailingSpace(theGlobalEditor.session, true);\r\n  } catch (e) {\r\n    console.error(e);\r\n  }\r\n  return theGlobalEditor?.getValue();\r\n}\r\n\r\nexport function confetti_cannon(){\r\n  const canvas = document.getElementById('confetti');\r\n  if (canvas) {\r\n    canvas.classList.remove('hidden');\r\n    // ignore this error, the function comes from CDN for now\r\n    const jsConfetti = new JSConfetti({canvas})\r\n    // timeout for the confetti to fall down\r\n    setTimeout(function(){canvas.classList.add('hidden')}, 3000);\r\n    jsConfetti.addConfetti();\r\n\r\n    const confettiButton = document.getElementById('confetti-button');\r\n    if (confettiButton) {\r\n      confettiButton.classList.add('hidden');\r\n    }\r\n  }\r\n}\r\n\r\nexport function toggle_developers_mode(hide_commands: boolean) {\r\n  if ($('#developers_toggle').is(\":checked\")) {\r\n      $('#commands-window-total').hide();\r\n      $('#adventures').hide();\r\n  } else {\r\n      // If the example programs are hidden by class customization: keep hidden!\r\n      if (hide_commands) {\r\n        $('#commands-window-total').show();\r\n      }\r\n      $('#adventures').show();\r\n  }\r\n\r\n  if ($('#adventures').is(\":hidden\")) {\r\n    $('#editor-area').removeClass('mt-5');\r\n    $('#code_editor').css('height', 36 + \"em\");\r\n    $('#code_output').css('height', 36 + \"em\");\r\n  } else {\r\n    $('#editor-area').addClass('mt-5');\r\n    $('#code_editor').height('22rem');\r\n    $('#code_output').height('22rem');\r\n  }\r\n}\r\n", "import { modal } from './modal';\r\nimport { auth } from './auth';\r\nimport { theGlobalEditor } from './app';\r\n\r\n/**\r\n * Activate tabs\r\n *\r\n * Protocol:\r\n *\r\n * - Tabs consist of a TAB (the sticky-outy bit) and a TARGET\r\n *   (the pane that gets shown and hidden).\r\n *\r\n * - TABS should have: <... data-tab=\"SOME-ID\">\r\n *\r\n * - TARGETS should have: <... data-tabtarget=\"SOME-ID\">\r\n *\r\n * When a TAB is clicked, the TARGET with the matching id is shown\r\n * (and all other TARGETS in the same containing HTML element are hidden).\r\n *\r\n * The active TAB is indicated by the  '.tab-selected' class, the active\r\n * TARGET by the *absence* of the '.hidden' class.\r\n */\r\n$(function() {\r\n  function resetWindow() {\r\n    $ ('#warningbox').hide ();\r\n    $ ('#errorbox').hide ();\r\n    $ ('#okbox').hide ();\r\n    $ ('#output').empty ();\r\n    $ ('#turtlecanvas').empty ();\r\n    window.State.unsaved_changes = false;\r\n  }\r\n\r\n  function switchToTab(tabName: string) {\r\n    // Find the tab that leads to this selection, and its siblings\r\n    const tab = $('*[data-tab=\"' + tabName + '\"]');\r\n    const allTabs = tab.siblings('*[data-tab]');\r\n\r\n    // Fidn the target associated with this selection, and its siblings\r\n    const target = $('*[data-tabtarget=\"' + tabName + '\"]');\r\n    const allTargets = target.siblings('*[data-tabtarget]');\r\n\r\n    // Fix classes\r\n    allTabs.removeClass('tab-selected');\r\n    tab.addClass('tab-selected');\r\n\r\n    allTargets.addClass('hidden');\r\n    target.removeClass('hidden');\r\n\r\n    const adventures: Record<string, Adventure> = {};\r\n    window.State.adventures?.map (function(adventure: Adventure) {\r\n      adventures [adventure.short_name] = adventure;\r\n    });\r\n\r\n    resetWindow();\r\n\r\n    if (tabName === 'end') {\r\n      $ ('#adventures-tab').css('max-height', '100%')\r\n      $ ('#level-header input').hide ();\r\n      $ ('#editor-area').hide ();\r\n      return;\r\n    }\r\n    $ ('#adventures-tab').css('max-height', '20em')\r\n    $ ('#level-header input').show ();\r\n    $ ('#editor-area').show ();\r\n\r\n\r\n    // If the loaded program (directly requested by link with id) matches the currently selected tab, use that, overriding the loaded program that came in the adventure or level.\r\n    if (window.State.loaded_program && (window.State.adventure_name_onload || 'level') === tabName) {\r\n      $ ('#program_name').val (window.State.loaded_program.name);\r\n      theGlobalEditor?.setValue (window.State.loaded_program.code);\r\n    }\r\n    // If there's a loaded program for the adventure or level now selected, use it.\r\n    else if (adventures[tabName]?.loaded_program) {\r\n      $ ('#program_name').val (adventures[tabName].loaded_program!.name);\r\n      theGlobalEditor?.setValue (adventures[tabName].loaded_program!.code);\r\n    }\r\n    // If there's no loaded program (either requested by id or associated to the adventure/level), load defaults.\r\n    else if (tabName === 'level' && window.State.default_program_name && window.State.default_program) {\r\n      $ ('#program_name').val(window.State.default_program_name);\r\n      theGlobalEditor?.setValue(window.State.default_program);\r\n    }\r\n    else {\r\n      $ ('#program_name').val (adventures [tabName].default_save_name + ' - ' + window.State.level_title + ' ' + window.State.level);\r\n      theGlobalEditor?.setValue (adventures [tabName].start_code);\r\n    }\r\n\r\n    window.State.adventure_name = tabName === 'level' ? undefined : tabName;\r\n    theGlobalEditor?.clearSelection();\r\n    // If user wants to override the unsaved program, reset unsaved_changes\r\n    window.State.unsaved_changes = false;\r\n  }\r\n\r\n  $('*[data-tab]').click(function (e) {\r\n    const tab = $(e.target);\r\n    const tabName = tab.data('tab');\r\n\r\n    e.preventDefault ();\r\n\r\n    // If there are unsaved changes, we warn the user before changing tabs.\r\n    if (window.State.unsaved_changes) modal.confirm(auth.texts['unsaved_changes'], () => switchToTab(tabName));\r\n    else switchToTab(tabName);\r\n\r\n    // Do a 'replaceState' to add a '#anchor' to the URL\r\n    const hashFragment = tabName !== 'level' ? tabName : '';\r\n    if (window.history) { window.history.replaceState(null, '', '#' + hashFragment); }\r\n  });\r\n\r\n  // If we're opening an adventure from the beginning (either through a link to /hedy/adventures or through a saved program for an adventure), we click on the relevant tab.\r\n  // We click on `level` to load a program associated with level, if any.\r\n  if (window.State && window.State.adventure_name) {\r\n    switchToTab(window.State.adventure_name);\r\n  }\r\n  else if (window.location.hash) {\r\n    // If we have an '#anchor' in the URL, switch to that tab\r\n    const hashFragment = window.location.hash.replace(/^#/, '');\r\n    if (hashFragment) {\r\n      switchToTab(hashFragment);\r\n    }\r\n  }\r\n});", "/**\r\n * Count newlines and also estimate how the text will be line wrapped\r\n */\r\nfunction estimateLineCount(s: string) {\r\n  var ESTIMATED_LINE_LENGTH = 80;\r\n\r\n  var lines = s.split('\\n');\r\n  var wrappedLines = lines.map(x => Math.floor(x.length / ESTIMATED_LINE_LENGTH));\r\n\r\n  return sum(wrappedLines) + lines.length;\r\n}\r\n\r\nfunction sum(xs: number[]) {\r\n  let ret = 0;\r\n  for (const x of xs) {\r\n    ret += x;\r\n  }\r\n  return ret;\r\n}\r\n\r\n\r\nfunction resizeArea(el: JQuery | HTMLElement) {\r\n  var lines = Math.max(1, estimateLineCount($(el).val() as string));\r\n  var targetHeight = lines * 25 + 4;\r\n\r\n  // Allow for the case where the user made it bigger themselves\r\n  if ($(el).height() as number < targetHeight) {\r\n    $(el).css({ height: `${targetHeight}px` });\r\n  }\r\n}\r\n\r\n$('textarea').each((_i, el) => resizeArea(el)).on('input', e => {\r\n  const target = $(e.target);\r\n  if (!target.hasClass('touched')) {\r\n    target.addClass('touched');\r\n\r\n    // Change the 'data-name=\"xxx\"' attribute into an actual 'name=\"xxx\"' attribute\r\n    // so that the value is actually submitted via the form.\r\n    target.attr('name', target.data('name'));\r\n\r\n    recordChangeToForm(target.closest('form'));\r\n  }\r\n\r\n  resizeArea(target);\r\n});\r\n\r\n\r\nvar FORM_MAP = new Map();\r\n\r\nfunction recordChangeToForm(form: JQuery) {\r\n  var fileName = form.data('file');\r\n  var formData = FORM_MAP.get(fileName);\r\n\r\n  if (!formData) {\r\n    var button = $('button[data-file=\"' + fileName + '\"]');\r\n    formData = {\r\n      button: button,\r\n      changes: 0,\r\n    }\r\n\r\n    FORM_MAP.set(fileName, formData);\r\n  }\r\n\r\n  formData.changes += 1;\r\n  formData.button.text(`${fileName} (${formData.changes})`);\r\n}\r\n\r\n$('button[data-file]').click(e => {\r\n  var fileName = $(e.target).data('file');\r\n  var form = $('form[data-file=\"' + fileName + '\"]');\r\n  form.submit();\r\n});\r\n"],
  "mappings": "0JAAA,6eCGA,WAAY,CACV,aAAc,CAEZ,EAAE,yBAAyB,GAAG,QAAS,IAAM,KAAK,QAClD,EAAE,oBAAoB,GAAG,QAAS,IAAM,KAAK,QAC7C,EAAE,wBAAwB,GAAG,QAAS,IAAM,KAAK,QAG5C,MAAO,CACZ,EAAE,eAAe,OACjB,EAAE,kBAAkB,OACpB,OAAO,SAAS,EAAG,GAGd,MAAO,CACZ,EAAE,eAAe,OACjB,EAAE,kBAAkB,OACpB,EAAE,gBAAgB,OAClB,EAAE,iBAAiB,OACnB,EAAE,kBAAkB,OAGf,MAAM,EAAiB,EAAoB,CAChD,EAAE,qBAAqB,KAAK,GAC5B,KAAK,OACL,EAAE,gBAAgB,OACd,GAAW,WAAW,IAAM,KAAK,OAAQ,GAGxC,QAAQ,EAAiB,EAAuB,CACrD,EAAE,uBAAuB,KAAK,GAC9B,KAAK,OACL,EAAE,kBAAkB,OAGpB,EAAE,qBAAqB,IAAI,SAAS,GAAG,QAAS,IAAM,CACpD,KAAK,OACL,MAIG,OAAO,EAAiB,EAAsB,EAAgC,CACnF,EAAE,sBAAsB,KAAK,GAC7B,KAAK,OACL,EAAE,iBAAiB,OACf,GAAc,EAAE,uBAAuB,IAAI,GAG/C,EAAE,oBAAoB,IAAI,SAAS,GAAG,QAAS,IAAM,CACnD,KAAK,OAEL,GAAM,GAAQ,EAAE,uBAAuB,MACvC,AAAI,MAAO,IAAU,UACnB,EAAU,OAMd,EAKS,EAAU,CACrB,UAAU,EAAmB,CAC3B,EAAS,GAGX,KAAM,UAAY,CAChB,EAAE,UAAU,OACZ,WAAQ,UAIV,YAAY,EAAiB,EAAiB,CAC5C,EAAE,mBAAmB,KAAK,GAC1B,EAAE,mBAAmB,KAAK,GAC1B,EAAE,UAAU,OACZ,WAAQ,UAGV,KAAK,EAAiB,CACpB,EAAE,mBAAmB,KAAK,GAC1B,EAAE,UAAU,OACZ,WAAQ,SACR,WAAW,UAAU,CAAM,EAAE,UAAU,OACvC,WAAQ,UAAa,OAIZ,EAAQ,CACnB,UAAU,EAAmB,CAC3B,EAAS,GAGX,MAAO,CACL,EAAE,aAAa,OACf,EAAE,eAAe,OACjB,WAAQ,UAGV,YAAY,EAAiB,EAAiB,CAC5C,EAAE,wBAAwB,KAAK,GAC/B,EAAE,wBAAwB,KAAK,GAC/B,EAAE,eAAe,OACjB,WAAQ,UAGV,KAAK,EAAiB,EAAiB,CACrC,EAAE,sBAAsB,KAAK,GAC7B,EAAE,sBAAsB,KAAK,GAC7B,EAAE,aAAa,OACf,WAAQ,WAIC,EAAQ,GAAI,GCxGzB,YAA4B,CAC1B,MAAO,CAEL,OAAQ,CACN,CACE,MAAO,KACP,MAAO,OACP,KAAM,UAMV,eAAgB,GAAW,CACzB,CACE,MAAO,UACP,MAAO,sBAET,CACE,MAAO,IAAM,IAAM,OACnB,MAAO,WAET,CACE,MAAO,IACP,MAAO,WAMf,GAAM,IAAS,CACb,CACE,KAAM,SACN,MAAO,EAAK,IACV,EAAgB,UAChB,IACA,EAAU,QAAS,CACjB,MAAO,EAAiB,OACxB,MAAO,UACP,KAAM,WAER,EAAU,QAAS,CACjB,MAAO,EAAiB,MACxB,MAAO,UACP,KAAM,aAIZ,CAEE,KAAM,SACN,MAAO,EAAK,IAEV,EAAgB,kBAChB,EAAW,UACX,EAAQ,UACR,IACA,OAIJ,CAEE,KAAM,SACN,MAAO,EAAK,IACV,IACA,EAAgB,kBAChB,IACA,MAGJ,CAEE,KAAM,SACN,MAAO,EAAK,IACV,IACA,IACA,IACA,IACA,MAGJ,CAEE,KAAM,SACN,MAAO,EAAK,IACV,IACA,IACA,IACA,IACA,IACA,MAGJ,CAEE,KAAM,SACN,MAAO,EAAK,IACV,IACA,IACA,IACA,IACA,IACA,IACA,MAGJ,CAEE,KAAM,SACN,MAAO,EAAK,IACV,IACA,IACA,IACA,IACA,IACA,IACA,MAGJ,CAEE,KAAM,SACN,MAAO,EAAK,IACV,IACA,IACA,IACA,IACA,IACA,IACA,MAGJ,CAEE,KAAM,cACN,MAAO,EAAK,IACV,IACA,IACA,IACA,IACA,IACA,IACA,IACA,MAGJ,CAEE,KAAM,UACN,MAAO,EAAK,IACV,IACA,IACA,IACA,IACA,IACA,IACA,MAGJ,CAEE,KAAM,UACN,MAAO,EAAK,IACV,IACA,IACA,IACA,IACA,IACA,IACA,MAMJ,CACE,KAAM,UACN,MAAO,EAAK,IACV,IACA,IACA,IACA,IACA,IACA,IACA,MAGJ,CACE,KAAM,UACN,MAAO,EAAK,IACV,IACA,IACA,IACA,IACA,IACA,IACA,MAGJ,CACE,KAAM,UACN,MAAO,EAAK,IACV,IACA,IACA,IACA,IACA,IACA,IACA,MAGJ,CACE,KAAM,UACN,MAAO,EAAK,IACV,IACA,IACA,IACA,IACA,IACA,IACA,MAGJ,CACE,KAAM,UACN,MAAO,EAAK,IACV,IACA,IACA,IACA,IACA,IACA,IACA,MAGJ,CACE,KAAM,UACN,MAAO,EAAK,IACV,IACA,IACA,IACA,IACA,IACA,IACA,MAGJ,CACE,KAAM,eACN,MAAO,EAAK,IACV,IACA,IACA,IACA,IACA,IACA,IACA,MAGJ,CACE,KAAM,UACN,MAAO,EAAK,IACV,IACA,IACA,IACA,IACA,IACA,IACA,MAGJ,CACE,KAAM,UACN,MAAO,EAAK,IACV,IACA,IACA,IACA,IACA,IACA,IACA,MAGJ,CACE,KAAM,UACN,MAAO,EAAK,IACV,IACA,IACA,IACA,IACA,IACA,IACA,MAGJ,CACE,KAAM,UACN,MAAO,EAAK,IACV,IACA,IACA,IACA,IACA,IACA,IACA,OAcN,YAAoB,EAAe,CACjC,GAAM,GAAM,GACZ,OAAW,KAAQ,GACjB,AAAI,EAAK,OACP,EAAI,KAAK,CACP,MAAO,EAAK,MAAQ,IACpB,MAAO,EAAK,MACZ,KAAM,UAGV,EAAI,KAAK,GAEX,MAAO,GAYT,WAAmB,EAAkC,EAA4B,CAC/E,MAAO,AAAC,IAAiB,CACvB,AAAK,MAAM,QAAQ,IACjB,GAAgB,CAAC,IAGnB,OAAW,KAAS,GAClB,AAAK,EAAM,IACT,GAAM,GAAS,IAEjB,AAAI,MAAM,QAAQ,GAChB,EAAM,GAAO,KAAK,GAAG,GAErB,EAAM,GAAO,KAAK,GAItB,MAAO,IASX,cAAiB,EAA6B,CAC5C,MAAO,AAAC,IAAa,CACnB,OAAW,KAAM,GACf,EAAM,EAAG,GAEX,MAAO,IAWX,WAAc,KAAa,EAA6B,CACtD,MAAO,GAAK,GAAG,GAAK,GAMtB,WAAyB,EAAe,CACtC,MAAO,GAAU,QAAS,CACxB,MAAO,EAAiB,QACxB,MAAO,UACP,KAAM,UAAQ,UAOlB,WAAoB,EAAe,CACjC,MAAO,GAAU,QAAS,CACxB,MAAO,WAAa,IAAM,IAAM,KAAO,IACvC,MAAO,CAAC,OAAQ,WAChB,KAAM,UAAQ,mBAOlB,WAAiB,EAAe,CAC9B,MAAO,GAAU,QAAS,CACxB,MAAO,WAAa,IAAM,KAC1B,MAAO,CAAC,OAAQ,WAChB,KAAM,UAAQ,mBAOlB,YAA2B,CACzB,MAAO,GAAU,QAAS,CACxB,MAAO,IAAM,OAAS,SACtB,MAAO,CAAC,UAAW,gBACnB,KAAM,UAIV,YAAuB,CACnB,MAAO,GACL,EAAU,QAAS,CAEjB,MAAO,MAAQ,iBACf,MAAO,UACP,KAAM,UAER,EAAU,QAAS,CACjB,MAAO,SACP,MAAO,UACP,KAAM,WAKd,aAAsB,CACpB,MAAO,GAAU,QAAS,CACtB,MAAO,QACP,MAAO,UACP,KAAM,UAYZ,YAA6B,CAC3B,MAAO,GAAU,QAAS,CACxB,MAAO,WAAa,IAAM,IAAM,OAAS,SACzC,MAAO,CAAC,OAAQ,UAAW,gBAC3B,KAAM,UAOV,YAA4B,CAC1B,MAAO,GACL,EAAU,QAAS,CACjB,MAAO,UACP,MAAO,uBAET,EAAU,QAAS,CACjB,MAAO,IAAM,OACb,MAAO,YAET,EAAU,QAAS,CACjB,MAAO,QACP,MAAO,0BASb,YAA8B,CAC5B,MAAO,GACL,EAAU,QAAS,CACjB,MAAO,EAAiB,KACxB,MAAO,UACP,KAAM,cAER,EAAU,QAAS,CACjB,MAAO,EAAiB,OACxB,MAAO,YAET,EAAU,YAAa,CACrB,MAAO,EAAiB,KAAO,IAAM,MAAQ,IAAM,MACnD,MAAO,UACP,KAAM,WAKZ,YAAuB,CACrB,MAAO,GACL,EAAU,QAAS,CACjB,MAAO,EAAiB,KACxB,MAAO,UACP,KAAM,cAER,EAAU,QAAS,CACjB,MAAO,MAAQ,MAAQ,MACvB,MAAO,YAET,EAAU,YAAa,CACrB,MAAO,EAAiB,KAAO,IAAM,MAAQ,IAAM,MACnD,MAAO,UACP,KAAM,WAQZ,YAA2B,CACzB,MAAO,GAAU,CAAC,QAAS,kBAAmB,CAC5C,CACE,MAAO,QACP,MAAO,WAET,CACE,MAAO,QACP,MAAO,WAET,CACE,MAAO,QACP,MAAO,aAQb,YAAuB,CACrB,MAAO,GAAU,QAAS,CACxB,MAAO,IAAM,QAAU,aAAe,OAAS,IAC/C,MAAO,CAAC,UAAW,OAAQ,aAI/B,YAAmB,CACjB,MAAO,GAAU,QAAS,CACxB,MAAO,IAAM,KAAO,aAAe,IAAM,WACzC,MAAO,CAAC,UAAW,OAAQ,UAAW,UAI1C,YAAyB,CACvB,MAAO,GAAU,QAAS,CACxB,MAAO,IAAM,KAAO,aAAe,IAAM,IAAM,OAAS,uBACxD,MAAO,CAAC,UAAW,OAAQ,UAAW,OAAQ,UAAW,UAI7D,YAA8B,CAC5B,MAAO,GAAU,QAAS,CACxB,MAAO,IAAM,KAAO,aAAe,IAAM,IAAM,OAAS,uCACxD,MAAO,CAAC,UAAW,OAAQ,UAAW,eAAgB,OAAQ,uBAAwB,OAAQ,kBAOlG,YAAqB,EAAc,CACjC,OAAW,KAAY,QAAO,OAAO,GACnC,OAAW,KAAQ,GACjB,AAAI,EAAK,OAAS,CAAE,EAAa,WAC9B,GAAa,MAAQ,EAAK,MAAM,QAAQ,KAAM,MAC9C,EAAa,UAAY,IAIhC,MAAO,GAQT,GAAK,OAAe,OAGlB,OAAW,KAAS,IAGlB,OAAO,YAAc,EAAM,KAAM,GAAI,SAAS,EAAS,EAAS,EAAS,CACvE,GAAI,GAAM,EAAQ,eACd,EAAW,EAAQ,iBAAiB,KACpC,EAAqB,EAAQ,iCAAiC,mBAElE,YAA4C,CAC1C,KAAK,OAAS,GAAY,EAAM,OAChC,KAAK,iBAEP,EAAI,SAAS,EAAyB,GAEtC,YAAyB,CACvB,KAAK,eAAiB,EAExB,EAAI,SAAS,EAAM,GAEnB,EAAQ,KAAO,IAarB,WAA0B,EAAiB,CACzC,MAAO,MAAQ,EAAU,IC/oBpB,aAAwB,CAC7B,EAAM,OAAQ,EAAK,MAAM,kBAAsB,GAAI,SAAU,EAAY,CACvE,GAAI,CAAC,EAAY,CACf,EAAM,MAAM,EAAK,MAAM,kBACvB,OAEF,EAAE,KAAK,CACL,KAAM,OACN,IAAK,SACL,KAAM,KAAK,UAAU,CACnB,KAAM,IAER,YAAa,mBACb,SAAU,SACT,KAAK,SAAS,EAAW,CAC1B,SAAS,WACR,KAAK,SAAS,EAAK,CACpB,GAAI,EAAI,cAAgB,YAAa,CACnC,EAAM,MAAM,EAAK,MAAM,sBACvB,OAEF,QAAQ,MAAM,GACd,EAAM,KAAK,cAAc,iBAAqB,KAAK,UAAU,QAK5D,YAAsB,EAAY,CACvC,EAAM,OAAQ,EAAK,MAAM,kBAAsB,GAAI,SAAU,EAAY,CACvE,GAAI,CAAC,EAAY,CACf,EAAM,MAAM,EAAK,MAAM,kBACvB,OAEF,EAAE,KAAK,CACL,KAAM,MACN,IAAK,UAAY,EACjB,KAAM,KAAK,UAAU,CACnB,KAAM,IAER,YAAa,mBACb,SAAU,SACT,KAAK,SAAS,EAAW,CAC1B,SAAS,WACR,KAAK,SAAS,EAAK,CACpB,GAAI,EAAI,cAAgB,YAAa,CACnC,EAAM,MAAM,EAAK,MAAM,sBACvB,OAEF,QAAQ,MAAM,GACd,EAAM,KAAK,cAAc,iBAAqB,KAAK,UAAU,QAK5D,YAAsB,EAAY,CACvC,EAAM,QAAS,EAAK,MAAM,oBAAwB,UAAY,CAE5D,EAAE,KAAK,CACL,KAAM,SACN,IAAK,UAAY,EACjB,YAAa,mBACb,SAAU,SACT,KAAK,SAAS,EAAW,CAC1B,OAAO,SAAS,SAAW,kBAC1B,KAAK,SAAS,EAAK,CACpB,QAAQ,MAAM,GACd,EAAM,KAAK,cAAc,iBAAqB,KAAK,UAAU,QAK5D,WAAoB,EAAc,EAAc,EAAW,GAAO,CAEvE,GAAI,CAAE,EAAK,QACT,MAAO,GAAM,QAAS,EAAK,MAAM,YAAgB,UAAY,CAC3D,aAAa,QAAS,YAAa,KAAK,UAAW,CAAC,KAAM,EAAM,KAAM,KACtE,OAAO,SAAS,SAAW,WAK/B,EAAE,KAAK,CACL,KAAM,MACN,IAAK,IACJ,KAAK,SAAS,EAAW,CAC1B,EAAM,MAAO,EAAK,MAAM,wBAA6B,IAAM,GACrD,GAAY,QAAO,SAAS,SAAW,eAC5C,KAAK,SAAS,EAAK,CACpB,QAAQ,MAAM,GACd,EAAM,KAAK,cAAc,iBAAqB,KAAK,UAAU,MAI1D,YAAwB,EAAkB,EAAoB,CACnE,EAAM,QAAS,EAAK,MAAM,sBAA0B,UAAY,CAE9D,EAAE,KAAK,CACL,KAAM,SACN,IAAK,UAAY,EAAW,YAAc,EAC1C,YAAa,mBACb,SAAU,SACT,KAAK,SAAS,EAAW,CAC1B,SAAS,WACR,KAAK,SAAS,EAAK,CACpB,QAAQ,MAAM,GACd,EAAM,KAAK,cAAc,iBAAqB,KAAK,UAAU,QAK5D,YAA6B,EAAY,EAAe,CAC1D,GAAI,GAAyC,GAC7C,EAAE,2BAA2B,KAAK,UAAW,CACzC,AAAI,EAAE,MAAM,GAAG,aAAe,EAAE,MAAM,KAAK,UAAU,KAAK,YACtD,EAAoB,KAAK,KAAK,aAAa,SAInD,GAAI,GAAW,EAAE,YAAa,GAAO,MACjC,EAA0B,GAC1B,EAAe,GACnB,AAAI,EAAE,cAAgB,GAAO,KAAK,YAChC,GAAe,IAEb,EAAE,oBAAsB,GAAO,KAAK,YACtC,GAA0B,IAI5B,EAAE,KAAK,CACL,KAAM,MACN,IAAK,oBAAsB,EAC3B,KAAM,KAAK,UAAU,CACnB,WAAY,EACZ,WAAY,EACZ,iBAAkB,EAClB,WAAY,EACZ,MAAO,IAET,YAAa,mBACb,SAAU,SACT,KAAK,SAAS,EAAW,CAC1B,SAAS,WACR,KAAK,SAAS,EAAK,CACpB,QAAQ,MAAM,GACd,EAAM,KAAK,cAAc,iBAAqB,KAAK,UAAU,MAI3D,YAAiC,EAAe,CACpD,EAAE,2BAA2B,KAAK,UAAW,CACzC,AAAI,EAAE,MAAM,GAAG,aACX,EAAE,MAAM,KAAK,UAAU,KAAK,UAAW,MAG/C,EAAE,YAAa,GAAO,IAAI,GAC1B,EAAE,oBAAsB,GAAO,KAAK,UAAW,IAC/C,EAAE,cAAgB,GAAO,KAAK,UAAW,IC5J9C,GAAM,GAAoC,CAAC,GAAK,cAAc,GAAK,mBAAgB,GAAK,UAAU,GAAK,UAAU,GAAK,iBAAiB,GAAK,UAAU,GAAK,SAAS,GAAK,WAAW,GAAK,aAAa,GAAK,sBAAsB,GAAK,YAAY,GAAK,UAAU,GAAK,QAAQ,GAAK,YAAY,GAAK,UAAU,GAAK,aAAa,GAAK,UAAU,GAAK,UAAU,GAAK,aAAa,GAAK,WAAW,GAAK,UAAU,GAAK,UAAU,GAAK,SAAS,GAAK,QAAQ,GAAK,UAAU,GAAK,SAAS,GAAK,kCAAkC,GAAK,mCAAmC,GAAK,yBAAyB,GAAK,WAAW,GAAK,gBAAgB,GAAK,SAAS,GAAK,iCAAiC,GAAK,oBAAoB,GAAK,WAAW,GAAK,eAAe,GAAK,UAAU,GAAK,WAAW,GAAK,WAAW,GAAK,SAAS,GAAK,aAAa,GAAK,iBAAiB,GAAK,2BAA2B,GAAK,OAAO,GAAK,QAAQ,GAAK,QAAQ,GAAK,mBAAmB,GAAK,0BAA0B,GAAK,WAAW,GAAK,UAAU,GAAK,QAAQ,GAAK,wCAAwC,GAAK,eAAe,GAAK,aAAa,GAAK,mBAAiB,GAAK,UAAU,GAAK,OAAO,GAAK,aAAU,GAAK,SAAS,GAAK,iBAAiB,GAAK,UAAU,GAAK,WAAW,GAAK,WAAW,GAAK,qBAAqB,GAAK,UAAU,GAAK,QAAQ,GAAK,cAAc,GAAK,oBAAoB,GAAK,UAAU,GAAK,UAAU,GAAK,WAAW,GAAK,8BAA8B,GAAK,gBAAgB,GAAK,OAAO,GAAK,UAAU,GAAK,SAAS,GAAK,gBAAgB,GAAK,mBAAmB,GAAK,8BAA8B,GAAK,QAAQ,GAAK,SAAS,GAAK,UAAU,GAAK,UAAU,GAAK,QAAQ,GAAK,YAAY,GAAK,SAAS,GAAK,YAAY,GAAK,UAAU,GAAK,aAAa,GAAK,OAAO,GAAK,YAAY,GAAK,WAAW,GAAK,SAAS,GAAK,gBAAgB,GAAK,SAAS,GAAK,QAAQ,GAAK,oCAAoC,GAAK,gCAAgC,GAAK,WAAW,GAAK,YAAY,GAAK,UAAU,GAAK,UAAU,GAAK,QAAQ,GAAK,YAAY,GAAK,4BAA4B,GAAK,OAAO,GAAK,UAAU,GAAK,cAAc,GAAK,SAAS,GAAK,QAAQ,GAAK,UAAU,GAAK,QAAQ,GAAK,SAAS,GAAK,SAAS,GAAK,aAAa,GAAK,QAAQ,GAAK,WAAW,GAAK,yCAA0C,GAAK,qBAAqB,GAAK,SAAS,GAAK,aAAa,GAAK,mCAAoC,GAAK,SAAS,GAAK,UAAU,GAAK,UAAU,GAAK,UAAU,GAAK,QAAQ,GAAK,gBAAgB,GAAK,YAAY,GAAK,aAAa,GAAK,QAAQ,GAAK,6CAA6C,GAAK,aAAa,GAAK,SAAS,GAAK,WAAW,GAAK,WAAW,GAAK,OAAO,GAAK,QAAQ,GAAK,mBAAmB,GAAK,aAAa,GAAK,aAAa,GAAK,YAAY,GAAK,UAAU,GAAK,SAAS,GAAK,kCAAkC,GAAK,uBAAuB,GAAK,SAAS,GAAK,WAAW,GAAK,aAAa,GAAK,aAAa,GAAK,UAAU,GAAK,aAAa,GAAK,UAAU,GAAK,UAAU,GAAK,QAAQ,GAAK,QAAQ,GAAK,cAAc,GAAK,gBAAgB,GAAK,cAAc,GAAK,YAAY,GAAK,QAAQ,GAAK,UAAU,GAAK,OAAO,GAAK,iBAAiB,GAAK,2BAA2B,GAAK,SAAS,GAAK,OAAO,GAAK,WAAW,GAAK,QAAQ,GAAK,sBAAsB,GAAK,SAAS,GAAK,mBAAmB,GAAK,WAAW,GAAK,OAAO,GAAK,cAAc,GAAK,WAAW,GAAK,SAAS,GAAK,WAAW,GAAK,cAAc,GAAK,QAAQ,GAAK,aAAU,GAAK,UAAU,GAAK,qBAAqB,GAAK,SAAS,GAAK,sBAAmB,GAAK,+CAA+C,GAAK,wBAAwB,GAAK,cAAc,GAAK,6BAA6B,GAAK,4BAA4B,GAAK,mCAAmC,GAAK,QAAQ,GAAK,aAAa,GAAK,wBAAwB,GAAK,eAAe,GAAK,UAAU,GAAK,SAAS,GAAK,aAAa,GAAK,eAAe,GAAK,YAAY,GAAK,4BAA4B,GAAK,WAAW,GAAK,WAAW,GAAK,kBAAkB,GAAK,UAAU,GAAK,eAAe,GAAK,+CAA+C,GAAK,cAAc,GAAK,QAAQ,GAAK,YAAY,GAAK,QAAQ,GAAK,WAAW,GAAK,yBAAyB,GAAK,YAAY,GAAK,SAAS,GAAK,cAAc,GAAK,uBAAuB,GAAK,4BAA4B,GAAK,aAAa,GAAK,+BAA+B,GAAK,WAAW,GAAK,cAAc,GAAK,OAAO,GAAK,UAAU,GAAK,QAAQ,GAAK,sBAAsB,GAAK,UAAU,GAAK,SAAS,GAAK,eAAe,GAAK,2BAA2B,GAAK,SAAS,GAAK,SAAS,GAAK,UAAU,GAAK,uBAAuB,GAAK,iBAAiB,GAAK,gBAAgB,GAAK,uCAAuC,GAAK,UAAU,GAAK,aAAa,GAAK,UAAU,GAAK,oCAAoC,GAAK,WAAW,GAAK,0BAA0B,GAAK,uBAAuB,GAAK,oBAAoB,GAAK,iBAAiB,GAAK,QAAQ,GAAK,SAAS,GAAK,YAgCtvJ,GAAI,CAAE,OAAe,aACnB,KAAM,IAAI,OAAM,gGAGX,GAAM,GAAO,CAClB,MAAO,aACP,QAAS,OACT,MAAO,OACP,UAAW,SAAU,EAAgB,CACjC,MAAO,GAAO,QAAS,KAAM,SAAS,QAAS,KAAM,QAAQ,QAAS,KAAM,QAAQ,QAAS,KAAM,UAAU,QAAS,KAAM,SAAS,QAAS,KAAM,UAExJ,WAAY,mEACZ,SAAU,SAAU,EAAe,CACjC,EAAQ,IAAM,EACd,OAAO,SAAS,SAAW,GAE7B,OAAQ,UAAY,CAClB,EAAE,KAAM,CAAC,KAAM,OAAQ,IAAK,iBAAiB,KAAM,UAAY,CAC7D,EAAK,SAAU,YAGnB,QAAS,UAAY,CACnB,EAAM,QAAS,EAAK,MAAM,aAAiB,UAAY,CACrD,EAAE,KAAM,CAAC,KAAM,OAAQ,IAAK,kBAAkB,KAAM,UAAY,CAC9D,EAAK,SAAU,SAIrB,MAAO,SAAU,EAAiB,EAAyB,EAAa,CACtE,EAAG,GAAM,UAAU,KAAM,GACzB,EAAG,GAAM,UAAU,IAAK,UAAW,SAC/B,GAAS,EAAG,IAAM,GAAS,IAAK,SAAU,kBAEhD,YAAa,SAAU,EAAa,CAClC,EAAG,GAAM,UAAU,KAAM,IACzB,EAAG,GAAM,UAAU,IAAK,UAAW,QACnC,EAAG,UAAU,IAAK,SAAU,KAE9B,QAAS,SAAU,EAAiB,EAAa,CAC/C,EAAG,UAAU,IAAK,UAAW,QAC7B,EAAG,GAAM,YAAY,KAAM,GAC3B,EAAG,GAAM,YAAY,IAAK,UAAW,UAEvC,OAAQ,SAAU,EAAY,CA/EhC,YAgFI,GAAM,GAAmB,GAKzB,GAJA,EAAG,4BAA4B,IAAK,SAAU,EAAI,EAAI,CACpD,AAAI,EAAG,IAAI,GAAO,EAAG,IAAyB,EAAwB,SAGpE,IAAO,SAAU,CACnB,GAAI,CAAE,EAAO,SAAU,MAAO,GAAK,MAAO,EAAK,MAAM,gBAAoB,YAEzE,GADA,EAAO,SAAW,EAAO,SAAS,OAC9B,EAAO,SAAS,OAAS,EAAG,MAAO,GAAK,MAAO,EAAK,MAAM,eAAmB,YACjF,GAAI,EAAO,SAAS,MAAO,OAAQ,MAAO,GAAK,MAAO,EAAK,MAAM,iBAAqB,YAEtF,GAAI,CAAE,MAAO,QAAP,cAAc,MAAO,EAAK,aAAa,MAAO,GAAK,MAAO,EAAK,MAAM,YAAgB,SAC3F,GAAI,EAAO,QAAU,EAAO,YAAa,MAAO,GAAK,MAAO,EAAK,MAAM,mBAA0B,eAEjG,GAAI,CAAE,EAAO,SAAU,MAAO,GAAK,MAAO,EAAK,MAAM,gBAAoB,YACzE,GAAI,EAAO,SAAS,OAAS,EAAG,MAAO,GAAK,MAAO,EAAK,MAAM,aAAiB,YAC/E,GAAI,EAAO,WAAa,EAAO,gBAAiB,MAAO,GAAK,MAAO,EAAK,MAAM,sBAA0B,mBAExG,GAAI,EAAO,YACL,CAAC,EAAqB,EAAO,YAC9B,MAAO,GAAK,MAAO,EAAK,MAAM,WAAgB,GAAI,QAAQ,cAAgB,cAI/E,GAAM,GAAgB,CACpB,SAAU,EAAO,SACjB,MAAO,EAAO,MACd,SAAU,EAAO,SACjB,WAAY,EAAO,WAAa,SAAS,EAAO,YAAc,OAC9D,QAAS,EAAO,QAAU,EAAO,QAAU,OAC3C,OAAQ,EAAO,OAAS,EAAO,OAAS,OACxC,UAAW,EAAE,cAAc,KAAK,WAChC,WAAY,EAAE,eAAe,KAAK,WAClC,gBAAiB,EAAE,sCAAsC,MACzD,qBAAsB,EAAE,cAAc,GAAG,YACrC,EAAE,yBAAyB,OAAO,YAAY,IAAI,CAAC,EAAG,IAAQ,EAAE,GAAK,OAAiB,MACtF,QAGN,EAAE,KAAM,CAAC,KAAM,OAAQ,IAAK,eAAgB,KAAM,KAAK,UAAW,GAAU,YAAa,oCAAoC,KAAM,UAAY,CAC7I,EAAK,QAAS,EAAK,MAAM,gBAGzB,EAAK,QAAU,CAAC,mBAAoB,KAAK,MAAS,IAAO,GAAK,GAAK,IAEnE,MACC,KAAM,SAAU,EAAU,CAC3B,GAAM,GAAQ,EAAS,cAAgB,GACvC,AAAI,EAAM,MAAO,SAAkB,EAAK,MAAO,EAAK,MAAM,cACrD,AAAI,EAAM,MAAO,YAAa,EAAK,MAAO,EAAK,MAAM,iBACvB,EAAK,MAAO,EAAK,MAAM,cAI9D,GAAI,IAAO,QAAS,CAClB,GAAI,CAAE,EAAO,SAAU,MAAO,GAAK,MAAO,EAAK,MAAM,sBAA0B,YAC/E,GAAI,CAAE,EAAO,SAAU,MAAO,GAAK,MAAO,EAAK,MAAM,gBAAoB,YAEzE,EAAK,cACL,EAAE,KAAM,CAAC,KAAM,OAAQ,IAAK,cAAe,KAAM,KAAK,UAAW,CAAC,SAAU,EAAO,SAAU,SAAU,EAAO,WAAY,YAAa,oCAAoC,KAAM,UAAY,CAG3L,EAAK,QAAU,CAAC,mBAAoB,KAAK,MAAS,IAAO,GAAK,GAAK,IAEnE,MACC,KAAM,SAAU,EAAU,CAjJnC,MAkJQ,AAAI,EAAS,SAAW,IACrB,GAAK,MAAO,EAAK,MAAM,0BAA+B,IAAM,EAAK,MAAM,WAAgB,uEAA2E,EAAK,MAAM,eAAoB,aACjM,EAAG,mBAAmB,OACtB,aAAa,QAAS,sBAAuB,KAAO,WAAP,OAAmB,KAE9D,EAAK,MAAO,EAAK,MAAM,cAIhC,GAAI,IAAO,UAAW,CACpB,GAAI,CAAG,MAAO,QAAP,OAAgB,IAAI,MAAO,EAAK,YAAa,MAAO,GAAK,MAAO,EAAK,MAAM,YAAgB,SAElG,GAAI,EAAO,YACL,CAAC,EAAqB,EAAO,YAC/B,MAAO,GAAK,MAAO,EAAK,MAAM,WAAgB,GAAI,QAAQ,cAAgB,cAI9E,GAAM,GAAgB,CACpB,MAAO,EAAO,MACd,WAAY,EAAO,WAAa,SAAS,EAAO,YAAiB,OACjE,QAAS,EAAO,QAChB,OAAQ,EAAO,OACf,gBAAiB,EAAG,sCAAsC,MAC1D,qBAAsB,EAAE,cAAc,GAAG,YACrC,EAAE,yBAAyB,OAAO,YAAY,IAAI,CAAC,EAAG,IAAQ,EAAE,GAAK,OAAiB,MACtF,QAGN,QAAQ,IAAI,GAEZ,EAAK,cACL,EAAE,KAAM,CAAC,KAAM,OAAQ,IAAK,WAAY,KAAM,KAAK,UAAW,GAAU,YAAa,oCAAoC,KAAM,UAAY,CACzI,EAAK,QAAS,EAAK,MAAM,mBACxB,KAAM,SAAU,EAAU,CAC3B,EAAK,MAAO,EAAK,MAAM,WAAgB,IAAM,EAAS,gBAI1D,GAAI,IAAO,kBAAmB,CAC5B,GAAI,CAAE,EAAO,SAAU,MAAO,GAAK,MAAO,EAAK,MAAM,gBAAoB,WAAY,mBACrF,GAAI,EAAO,SAAS,OAAS,EAAG,MAAO,GAAK,MAAO,EAAK,MAAM,aAAiB,WAAY,mBAC3F,GAAI,EAAO,WAAa,EAAO,gBAAiB,MAAO,GAAK,MAAO,EAAK,MAAM,aAAiB,kBAAmB,mBAElH,GAAM,GAAU,CAAC,aAAc,EAAO,aAAc,aAAc,EAAO,UAEzE,EAAK,YAAa,mBAClB,EAAE,KAAM,CAAC,KAAM,OAAQ,IAAK,wBAAyB,KAAM,KAAK,UAAW,GAAU,YAAa,oCAAoC,KAAM,UAAY,CACtJ,EAAK,QAAS,EAAK,MAAM,iBAAqB,qBAC9C,EAAG,iBAAiB,IAAK,IACzB,EAAG,aAAa,IAAK,IACrB,EAAG,oBAAoB,IAAK,MAC3B,KAAM,SAAU,EAAU,CAC3B,AAAI,EAAS,SAAW,IAAK,EAAK,MAAO,EAAK,MAAM,iBAAqB,KAAM,mBAClD,EAAK,MAAO,EAAK,MAAM,WAAe,KAAM,qBAI7E,GAAI,IAAO,UAAW,CACpB,GAAI,CAAE,EAAO,SAAU,MAAO,GAAK,MAAO,EAAK,MAAM,gBAAoB,YAEzE,GAAM,GAAU,CAAC,SAAU,EAAO,UAElC,EAAK,cACL,EAAE,KAAM,CAAC,KAAM,OAAQ,IAAK,gBAAiB,KAAM,KAAK,UAAW,GAAU,YAAa,oCAAoC,KAAM,UAAY,CAC9I,EAAK,QAAS,EAAK,MAAM,wBACzB,EAAG,aAAa,IAAK,MACpB,KAAM,SAAU,EAAU,CAC3B,AAAI,EAAS,SAAW,IAAK,EAAK,MAAO,EAAK,MAAM,kBACvB,EAAK,MAAO,EAAK,MAAM,cAIxD,GAAI,IAAO,QAAS,CAClB,GAAI,CAAE,EAAO,SAAU,MAAO,GAAK,MAAO,EAAK,MAAM,gBAAoB,YACzE,GAAI,EAAO,SAAS,OAAS,EAAG,MAAO,GAAK,MAAM,EAAK,MAAM,aAAiB,YAC9E,GAAI,EAAO,WAAa,EAAO,gBAAiB,MAAO,GAAK,MAAO,EAAK,MAAM,aAAiB,mBAE/F,GAAM,GAAU,CAAC,SAAU,KAAK,QAAL,cAAa,SAAa,MAAO,KAAK,QAAL,cAAa,MAAU,SAAU,EAAO,UAEpG,EAAK,cACL,EAAE,KAAM,CAAC,KAAM,OAAQ,IAAK,cAAe,KAAM,KAAK,UAAW,GAAU,YAAa,oCAAoC,KAAM,UAAY,CAC5I,EAAK,QAAS,EAAK,MAAM,mBACzB,EAAG,aAAa,IAAK,IACrB,EAAG,oBAAoB,IAAK,IAC5B,MAAO,GAAK,MACZ,EAAK,SAAU,WACd,KAAM,SAAU,EAAU,CAC3B,AAAI,EAAS,SAAW,IAAK,EAAK,MAAO,EAAK,MAAM,oBACvB,EAAK,MAAO,EAAK,MAAM,gBAI1D,cAAe,SAAU,EAAkB,EAAqB,CAC9D,EAAE,KAAM,CAAC,KAAM,OAAQ,IAAK,uBAAwB,KAAM,KAAK,UAAW,CAAC,SAAU,EAAU,WAAY,IAAc,YAAa,oCAAoC,KAAM,UAAY,CAC1L,EAAM,MAAO,CAAC,OAAQ,EAAU,eAAgB,EAAa,SAAW,WAAY,cAAc,KAAM,KAAM,KAC9G,SAAS,WACR,KAAM,SAAU,EAAO,CACxB,QAAQ,IAAK,GACb,EAAM,MAAO,CAAC,aAAc,EAAa,UAAY,YAAa,OAAQ,EAAU,cAAc,KAAM,SAI5G,gBAAiB,SAAU,EAAkB,EAAe,CAC1D,EAAM,OAAQ,mCAAoC,EAAO,SAAU,EAAgB,CACjF,GAAI,IAAmB,EACvB,IAAI,CAAE,EAAe,MAAO,EAAK,YAAa,MAAO,GAAM,MAAO,+BAClE,EAAE,KAAM,CAAC,KAAM,OAAQ,IAAK,yBAA0B,KAAM,KAAK,UAAW,CAAC,SAAU,EAAU,MAAO,IAAkB,YAAa,oCAAoC,KAAM,UAAY,CAC3L,EAAM,MAAO,CAAC,0CAA2C,EAAU,KAAM,GAAgB,KAAM,MAC/F,SAAS,WACR,KAAM,SAAU,EAAO,CACxB,QAAQ,IAAK,GACb,EAAM,MAAO,CAAC,yCAA0C,GAAU,KAAM,aAQhF,GAAI,EAAG,YAAa,CAClB,GAAI,GAAO,EAAE,YAAY,OACzB,OAAO,KAAM,GAAW,IAAK,SAAU,EAAM,CAC3C,GAAQ,kBAAoB,EAAO,KAAO,EAAW,GAAQ,cAE/D,EAAG,YAAY,KAAM,GAGvB,EAAG,eAAe,MAAO,IAAK,SAAU,EAAI,CAE1C,EAAG,iBAAkB,QAAS,IAAM,EAAK,iBAI3C,EAAE,KAAM,CAAC,KAAM,MAAO,IAAK,aAAa,KAAM,SAAU,EAAU,CAChE,AAAI,CAAC,UAAW,UAAU,QAAS,OAAO,SAAS,YAAc,IAAI,EAAK,SAAU,cAEpF,EAAK,QAAU,EACX,EAAG,YAAY,QACjB,GAAG,aAAa,KAAM,EAAS,UAC/B,EAAG,UAAU,IAAK,EAAS,OAC3B,EAAG,eAAe,IAAK,EAAS,YAChC,EAAG,WAAW,IAAK,EAAS,QAC5B,EAAG,YAAY,IAAK,EAAS,SACzB,EAAS,iBACX,GAAG,qCAAuC,EAAS,gBAAkB,MAAM,KAAM,UAAW,IACxF,EAAS,kBAAoB,OAAO,EAAG,cAAc,QAE1D,GAAS,sBAAwB,IAAI,IAAK,SAAU,EAAc,CAChE,EAAG,gCAAkC,EAAO,MAAM,KAAM,UAAW,MAEtE,AAAM,OAAO,cAAc,EAAS,iBAKlC,EAAG,oBAAoB,OAJvB,EAAG,uBAAuB,KAAO,GAAS,iBAAmB,IAAI,IAAK,SAAU,EAAc,CAC5F,MAAO,OAAS,EAAK,UAAW,EAAM,MAAQ,UAC7C,KAAM,QAKZ,KAAM,SAAU,EAAW,CAC5B,AAAI,OAAO,SAAS,SAAS,QAAS,iBAAmB,IAAI,EAAK,SAAU,WAG9E,GAAI,OAAO,SAAS,WAAa,SAAU,CACzC,GAAM,GAAQ,OAAO,SAAS,OAAO,MAAO,GAAG,MAAO,KAChD,EAAiC,GACvC,EAAM,IAAK,SAAU,EAAM,CACzB,GAAM,GAAQ,EAAK,MAAO,KAC1B,EAAQ,EAAO,IAAM,mBAAoB,EAAO,MAGlD,AAAI,CAAE,EAAO,UAAe,CAAE,EAAO,MAAU,EAAK,SAAU,WACzD,EAAK,MAAQ,EAGpB,GAAI,OAAO,SAAS,WAAa,UAAW,CAC1C,GAAM,GAAiB,aAAa,QAAS,uBAC7C,AAAI,GACF,cAAa,WAAY,uBACzB,AAAI,EAAe,MAAO,KAAM,EAAG,UAAU,IAAK,GAClB,EAAG,aAAa,IAAK,IAIzD,EAAG,wBAAwB,GAAI,iBAAkB,SAAU,EAAG,CAC3D,SAAE,iBACK,KAcV,kBAA4B,CAC1B,GAAM,GAAqB,aAAa,QAAQ,mBAC1C,EAAe,EAAqB,KAAK,MAAM,GAAsB,OAE3E,GAAI,EAAc,CAChB,KAAM,GAAQ,EAAa,GAAI,EAAa,GAAI,EAAa,GAAI,EAAa,IAC9E,aAAa,WAAW,mBAExB,GAAM,GAAW,IACjB,GAAI,EACF,MAAO,GAAK,SAAS,GAIzB,GAAM,GAAkB,aAAa,QAAQ,aACvC,EAAY,EAAkB,KAAK,MAAM,GAAmB,OAClE,GAAI,EACF,oBAAa,WAAW,aACjB,EAAW,EAAU,KAAM,EAAU,MAG9C,GAAM,GAAW,IACjB,GAAI,EACF,MAAO,GAAK,SAAS,GAGvB,EAAK,SAAS,YAGhB,YAAgC,CAC9B,GAAM,GAAW,aAAa,QAAQ,sBACtC,MAAI,IACF,aAAa,WAAW,sBAEnB,EAGT,WAA8B,EAAc,CAC1C,GAAM,GAAa,SAAU,GAC7B,MAAI,GAAE,GAAc,EAAa,MAAQ,EAAa,GAAI,QAAQ,eC3X7D,GAAI,GAEX,AAAC,WAAW,CAGV,AAAK,OAAO,OACV,QAAO,MAAQ,IAIjB,EAAqB,EAAE,YAIvB,OAAW,KAAW,GAAE,0BAA0B,MAAO,CACvD,EAAE,GAAS,SAAS,mBACpB,GAAM,GAAgB,EAAkB,EAAS,IAOjD,GALA,EAAc,WAAW,CAAE,SAAU,MACrC,EAAc,WAAW,CAAE,SAAU,IAErC,EAAc,SAAS,EAAc,WAAW,QAAQ,OAAQ,IAAK,IAE/D,EAAE,GAAS,SAAS,mBAMxB,GAAG,EAAE,GAAS,KAAK,MAAM,CAEvB,GAAI,GAAQ,OAAO,EAAE,GAAS,KAAK,OAC7B,EAAO,EAAe,SAAS,IACrC,EAAc,QAAQ,QAAQ,QAVW,CAC3C,GAAM,GAAkB,EAAE,SAAS,IAAI,CAAE,SAAU,WAAY,IAAK,EAAG,MAAO,EAAG,MAAO,SAAU,SAAS,GAC3G,EAAE,YAAY,KAAK,QAAS,WAAW,YAAe,IAAI,CAAE,WAAY,eAAgB,SAAS,aAAa,KAAK,UAAK,SAAS,GAAiB,MAAM,UAAW,CACjK,WAAiB,SAAS,EAAc,WAAa;AAAA,MAe3D,WAA8B,EAAiB,CAC7C,GAAI,CAAC,EAAQ,OAAQ,OAGrB,GAAI,GAAS,EAAkB,EAAQ,IAAI,GAAK,EAAQ,KAAK,aAC7D,EAAkB,EAClB,EAAM,UAAU,GAEhB,OAAO,MAAQ,IAAI,QAAQ,aAAa,MAGxC,GAAM,GAAU,OAAO,eACvB,GAAI,EAAS,CACX,GAAM,GAAW,EAAQ,KAAK,SACxB,EAAgB,EAAQ,KAAK,kBAG7B,EAAqB,EAAQ,QAAQ,GAC3C,AAAI,IAAkB,QAAU,GAC9B,EAAO,SAAS,EAAoB,GAItC,EAAO,GAAG,OAAQ,SAAS,EAAW,CACpC,EAAQ,QAAQ,EAAU,EAAO,cAInC,EAAO,GAAG,SAAU,UAAY,CAC9B,AAAI,EAAE,iBAAiB,GAAI,aAAa,EAAE,iBAAiB,OAC3D,OAAO,MAAM,YAAc,GAC3B,EAAG,UAAU,IAAI,mBAAoB,IACrC,OAAO,MAAM,gBAAkB,GAE/B,GAAY,KAMhB,OAAO,eAAiB,IAAM,CAE5B,GAAI,OAAO,MAAM,iBAAmB,CAAC,OAAO,MAAM,iBAChD,MAAO,GAAK,MAAM,iBAQtB,GAAI,GAGJ,cAAO,iBAAkB,UAAW,SAAU,EAAI,CAChD,GAAM,GAAU,EAAG,QACnB,GAAI,IAAY,GAAI,CAClB,EAAa,GACb,OAEF,GAAI,IAAY,IAAM,EAAY,CAChC,GAAI,CAAC,OAAO,MAAM,OAAS,CAAC,OAAO,MAAM,KACvC,KAAM,IAAI,OAAM,SAElB,GAAO,OAAO,MAAM,MAAO,OAAO,MAAM,KAAM,UAAY,CACxD,EAAG,WAAW,UAIlB,AAAI,IAAY,IAAM,SAAS,gBAAkB,SAAS,eAAgB,WACxE,GAAO,QACP,EAAO,qBAGX,OAAO,iBAAkB,QAAS,SAAU,EAAI,CAE9C,GAAI,AADY,EAAG,UACH,GAAI,CAClB,EAAa,GACb,UAGG,EAMT,WAA2B,EAAsB,EAAqC,CACpF,GAAM,GAAS,IAAI,KAAK,GACxB,EAAO,SAAS,qBACZ,GACF,EAAO,WAAW,CAChB,SAAU,GACV,WAAY,GACZ,gBAAiB,GACjB,oBAAqB,KAKzB,GAAI,GAAc,EAElB,GAAI,GAAe,GAGb,OAAO,MAAM,MAAO,CACtB,GAAM,GAAO,EAAe,SAAS,OAAO,MAAM,QAClD,EAAO,QAAQ,QAAQ,GAI3B,MAAO,QAIX,WAAwB,EAAe,CAOrC,MAAO,AANwC,CACzC,IAAK,uBACL,KAAM,uBACN,KAAM,wBACN,KAAM,yBAEU,IAAU,iBAAmB,EAGrD,YAAmC,CAEhC,MAAI,CAAE,EAAK,SAAW,EAAK,QAAQ,mBAAqB,KAAK,MAAe,GAE5E,UAAS,SACF,IAGV,YAAqB,EAAwB,CAC3C,EAAO,QAAQ,mBACf,OAAW,KAAU,GAAO,QAAQ,WAAW,IAC7C,EAAO,QAAQ,aAAa,GAIzB,YAAe,EAAe,EAAc,EAAgB,CACjE,GAAI,OAAO,MAAM,YAAa,MAAO,GAAM,MAAO,EAAK,MAAM,iBAE7D,GAAI,KAEJ,GAAM,OACN,EAAQ,OACR,GAAI,CACF,EAAQ,EAAM,WACd,GAAI,GAAS,EACT,EAAO,IAEX,GAAY,GAEZ,QAAQ,IAAI;AAAA,EAAuB,GACnC,EAAE,KAAK,CACL,KAAM,OACN,IAAK,SACL,KAAM,KAAK,UAAU,CACnB,MAAO,EACP,KAAM,EACN,KAAM,EACN,WAAa,CAAC,CAAC,EAAE,mBAAmB,MACpC,eAAgB,OAAO,MAAM,iBAE/B,YAAa,mBACb,SAAU,SACT,KAAK,SAAS,EAAe,CAK9B,GAJA,QAAQ,IAAI,WAAY,GACpB,EAAS,SACX,EAAM,YAAY,cAAc,kBAAsB,EAAS,SAE7D,EAAS,MAAO,CAClB,EAAM,KAAK,cAAc,gBAAoB,EAAS,OAClD,EAAS,UAAY,EAAS,SAAS,IAAM,KAG/C,GAAkB,EAAQ,EAAS,SAAS,GAAI,EAAS,SAAS,IAEpE,OAEF,GAAI,EAAS,KAAK,CAChB,QAAQ,IAAI,YACZ,GAAI,GAAqB,cAAc,kBACnC,EAAoB,KAAK,MAAM,KAAK,SAAW,EAAmB,QACtE,EAAQ,KAAK,EAAmB,IAElC,GAAiB,EAAS,KAAM,EAAS,WAAY,GAAI,MAAM,SAAS,EAAK,CAC3E,QAAQ,IAAI,GACZ,EAAM,KAAK,cAAc,cAAkB,EAAI,SAC/C,GAAkB,EAAO,EAAM,EAAI,aAEpC,KAAK,SAAS,EAAK,CACpB,QAAQ,MAAM,GAEd,AAAI,EAAI,WAAa,EACnB,EAAM,KAAK,cAAc,iBAAqB,cAAc,eAE5D,EAAM,KAAK,cAAc,YAAgB,cAAc,qBAIpD,EAAP,CACA,QAAQ,MAAM,GACd,EAAM,KAAK,cAAc,YAAgB,EAAE,WAgB/C,YAA2B,EAAwB,EAAa,EAAc,EAAO,EAAG,CAatF,GATA,EAAO,QAAQ,eAAe,CAC5B,CACE,IAAK,EAAM,EACX,OAAS,WAAO,GAAK,EACrB,KAAM,GACN,KAAM,WAIN,IAAQ,OAAW,CAErB,EAAO,QAAQ,UACb,GAAI,KAAI,MAAM,EAAM,EAAG,EAAG,EAAM,EAAG,GACnC,eAAgB,WAAY,IAE9B,OAIF,EAAO,QAAQ,UACb,GAAI,KAAI,MACN,EAAM,EAAG,EAAM,EACf,EAAM,EAAG,EAAM,EAAI,GAErB,eAAgB,OAAQ,IAOrB,YAAwB,EAAqB,CAClD,GAAI,EAAK,QACP,GAAI,OAAO,MAAM,cAAgB,EAC/B,OAAO,MAAM,cAAgB,OAAO,MAAM,cAAgB,MACrD,CACL,EAAE,oBAAoB,OACtB,EAAE,kBAAkB,OACpB,EAAM,MAAM,EAAK,MAAM,eACvB,OAGJ,GAAI,GAAS,IAAI,KAAK,UAElB,EAAqB,EACzB,EAAO,SAAS,EAAc;AAAA,EAAM,GACpC,OAAO,MAAM,gBAAkB,GAG1B,WAAgB,EAAkC,EAAc,EAAc,EAAc,EAAqC,CAItI,GAHA,EAAM,OACN,EAAQ,OAEJ,KAEJ,GAAI,CAEF,GAAI,CAAE,EAAK,QACR,MAAO,GAAM,QAAS,EAAK,MAAM,YAAgB,UAAY,CAE3D,AAAI,OAAO,OAAS,OAAO,MAAM,gBAAkB,CAAC,MAAM,QAAQ,IAAQ,GAAQ,CAAC,EAAO,OAAO,MAAM,iBACvG,aAAa,QAAS,kBAAmB,KAAK,UAAW,CAAC,EAAO,EAAM,EAAM,KAC7E,OAAO,SAAS,SAAW,WAIhC,OAAO,MAAM,gBAAkB,GAE/B,GAAI,GAAiB,OAAO,MAAM,eAElC,AAAI,MAAM,QAAQ,IACf,GAAiB,EAAO,GACxB,EAAQ,EAAO,IAGlB,EAAE,KAAK,CACL,KAAM,OACN,IAAK,YACL,KAAM,KAAK,UAAU,CACnB,MAAO,EACP,KAAO,EACP,KAAO,EACP,KAAO,EACP,eAAgB,IAElB,YAAa,mBACb,SAAU,SACT,KAAK,SAAS,EAAU,CAtW/B,MAwWM,GAAI,EAAI,MAAO,GAAS,MAAQ,EAAI,GAAY,EAAI,KAAM,GAI1D,GAHI,EAAS,SACX,EAAM,YAAY,cAAc,kBAAsB,EAAS,SAE7D,EAAS,MAAO,CAClB,EAAM,KAAK,cAAc,gBAAoB,EAAS,OACtD,OAEF,EAAM,MAAO,EAAK,MAAM,oBAAwB,KAIhD,EAAG,iBAAiB,IAAK,EAAS,MAClC,UAAO,MAAM,aAAb,QAAyB,IAAK,SAAU,EAAW,CACjD,AAAI,EAAU,aAAgB,IAAkB,UAC9C,GAAU,eAAiB,CAAC,KAAM,EAAS,KAAM,KAAM,QAG1D,KAAK,SAAS,EAAK,CACpB,QAAQ,MAAM,GACd,EAAM,KAAK,cAAc,iBAAqB,KAAK,UAAU,IACzD,EAAI,SAAW,KAChB,cAAa,QAAS,kBAAmB,KAAK,UAAW,CAAC,EAAiB,CAAC,EAAO,GAAkB,EAAO,EAAM,EAAM,KACxH,aAAa,QAAS,qBAAsB,QAC5C,OAAO,SAAS,SAAW,kBAGzB,EAAP,CACA,QAAQ,MAAM,GACd,EAAM,KAAK,cAAc,YAAgB,EAAE,UAOxC,WAAiB,EAAkC,EAAc,EAAc,EAAc,CAClG,MAAO,IAAI,SAAa,CAAC,EAAI,IAAO,CAClC,EAAO,EAAO,EAAM,EAAM,EAAM,CAAC,EAAK,IAAa,CACjD,AAAI,EACF,EAAG,GAEH,EAAG,OAMJ,YAAyB,EAAmB,CACjD,MAAO,QAAO,SAAS,OAAS,SAAW,EAAY,QAGlD,YAAwB,EAAe,EAAc,EAAmB,EAAiB,EAAkB,CAChH,GAAI,CAAE,EAAK,QAAS,MAAO,GAAM,MAAO,EAAK,MAAM,gBAEnD,GAAI,GAAQ,SAAU,EAAY,CAChC,EAAE,KAAK,CACL,KAAM,OACN,IAAK,kBACL,KAAM,KAAK,UAAU,CACnB,GAAI,EACJ,OAAQ,IAEV,YAAa,mBACb,SAAU,SACT,KAAK,SAAS,EAAW,CAE1B,AAAI,GAAQ,GAAmB,GAAgB,GAAK,IACpD,EAAM,MAAO,EAAS,EAAK,MAAM,qBAA0B,EAAK,MAAM,uBAA2B,KAC7F,GAAQ,WAAY,UAAY,CAAC,SAAS,UAAY,OACzD,KAAK,SAAS,EAAK,CACpB,QAAQ,MAAM,GACd,EAAM,KAAK,cAAc,iBAAqB,KAAK,UAAU,OAKjE,GAAI,IAAO,GAAM,MAAO,GAAO,GAK/B,GAAM,GAAO,GAAG,EAAE,iBAAiB,QAC7B,EAAO,IACb,MAAO,GAAO,EAAO,EAAM,EAAM,EAAM,CAAC,EAAU,IAAc,CAC5D,GAAI,GAAO,EAAI,QACb,MAAO,GAAM,YAAY,cAAc,kBAAsB,EAAI,SACnE,GAAI,GAAO,EAAI,MACb,MAAO,GAAM,KAAK,cAAc,gBAAoB,EAAI,OAC1D,EAAM,EAAK,MAKV,YAA4B,EAAgB,EAAkB,CAtcrE,QAwcE,GAAI,GAAK,SAAS,cAAe,YACjC,EAAG,MAAQ,EACX,EAAG,aAAc,WAAY,IAC7B,EAAG,MAAM,SAAW,WACpB,EAAG,MAAM,KAAO,UAChB,SAAS,KAAK,YAAa,GAE3B,GAAM,GAAY,SAAS,eACrB,EAAoB,GAAa,EAAU,WAAa,EAAI,EAAU,WAAW,GAAK,OAE5F,EAAG,SACH,SAAS,YAAa,QACtB,SAAS,KAAK,YAAa,GACvB,GACD,aAAS,iBAAT,QAAyB,kBACzB,YAAS,iBAAT,QAAyB,SAAU,IAEhC,GAAS,EAAM,MAAO,EAAK,MAAM,eAAmB,KAM5D,YAA2B,EAAe,EAAc,EAAsB,CAC5E,EAAE,KAAK,CACL,KAAM,OACN,IAAK,gBACL,KAAM,KAAK,UAAU,CACnB,MAAO,EACP,KAAM,EACN,KAAM,OAAO,SAAS,KACtB,aAAc,IAEhB,YAAa,mBACb,SAAU,SAId,OAAO,QAAU,SAA+B,EAAS,EAAQ,EAAa,EAAe,EAAO,CAElG,EAAE,KAAK,CACL,KAAM,OACN,IAAK,oBACL,KAAM,KAAK,UAAU,CACnB,QAAS,EACT,OAAQ,EACR,YAAa,EACb,cAAe,EACf,MAAO,EACP,IAAK,OAAO,SAAS,KACrB,WAAY,UAAU,YAExB,YAAa,mBACb,SAAU,UAId,YAA0B,EAAc,EAAoB,EAAgB,CAI1E,AAAM,OAAO,MAAM,qBAAqB,QAAO,MAAM,oBAAsB,GAC3E,OAAO,MAAM,sBAEb,GAAM,GAAY,EAAE,WACpB,EAAU,QAEV,GAAG,IAAM,SACT,GAAM,GAAgB,GAAG,gBAAmB,IAAG,eAAiB,IAChE,SAAa,OAAS,eACtB,AAAI,EAAE,eAAe,GAAG,WACpB,GAAa,OAAS,IACtB,EAAa,YAAc,KAE3B,GAAa,OAAS,IACtB,EAAa,YAAc,KAE/B,EAAa,MAAQ,IACrB,EAAa,WAAa,IAErB,GAGH,EAAE,iBAAiB,QAGrB,GAAG,UAAU,CACX,OAAQ,EACR,KAAM,EACN,SAAU,EACV,oBAAqB,GACrB,WAAY,GAAG,QACf,WAAY,UAAY,CAAC,MAAO,eAAe,kBAG/C,UAAY,UAAY,CAEtB,MAAS,GAAa,IAAQ,SAI3B,GAAG,SAAS,eAAe,UAAY,CAC5C,MAAO,IAAG,mBAAmB,UAAW,GAAO,EAAM,MACpD,KAAK,SAAS,EAAM,CACrB,QAAQ,IAAI,oBAER,OAAO,MAAM,sBAAwB,GAAK,EAAE,WAAW,GAAG,WAAa,EAAE,iBAAiB,GAAG,WAC/F,EAAM,YAAY,cAAc,kBAAsB,cAAc,cAEtE,OAAO,MAAM,sBACT,GAAI,MACP,MAAM,SAAS,EAAK,CAErB,QAAQ,IAAI,GACZ,GAAM,GAAe,EAA4B,IAAQ,KAAK,UAAU,GACxE,KAAM,IAAI,OAAM,KAYlB,WAAqC,EAAU,CAE7C,MADgB,GAAI,MAAQ,EAAI,KAAK,GAAK,EAAI,KAAK,EAAE,IAAM,EAAI,KAAK,EAAE,GAAG,EAI3E,WAAqB,EAAc,EAAe,CAChD,EAAE,UAAU,KAAK,GAAM,IAAI,CAAE,UAAS,SAAS,GAKjD,WAAc,EAAc,CAG1B,AAAI,OAAO,MAAM,oBAAsB,GACvC,GAAY,EAAM,SAClB,GAAM,IAGR,WAAqB,EAAW,CAC9B,GAAI,GAAG,eAAiB,QAAa,GAAG,aAAa,MAAS,KAAO,OACjE,KAAM,oBAAsB,EAAI,IACpC,MAAO,IAAG,aAAa,MAAS,GAIlC,WAA8B,EAAgB,CAE5C,UAAG,UAAY,GAAI,MAAM,GAAI,QAAQ,UAAa,IAAO,GAAK,GAAK,GAAK,KACxE,EAAE,iBAAiB,QACZ,GAAI,SAAQ,SAAS,EAAI,CAE9B,OAAO,MAAM,YAAc,GAC3B,EAAG,UAAU,IAAI,mBAAoB,QAErC,GAAM,GAAQ,EAAE,oCAChB,EAAE,0BAA0B,KAAK,GACjC,EAAM,IAAI,IACV,EAAM,KAAK,cAAe,GAC1B,GAAM,GAEN,WAAW,UAAW,CACpB,EAAM,SACL,GACH,EAAE,sBAAsB,IAAI,SAAU,SAAS,EAAO,CAEpD,cAAO,MAAM,YAAc,GAC3B,EAAG,UAAU,IAAI,mBAAoB,IAErC,EAAM,iBACN,EAAE,iBAAiB,OAEnB,GAAG,UAAY,GAAI,MAInB,WAAY,UAAY,CACrB,EAAG,EAAM,OACT,EAAG,WAAW,SACd,GAEI,KAET,EAAE,iBAAiB,UAKzB,YAAe,EAAc,CAC3B,GAAI,GAAc,EAAE,mBAAmB,MACvC,GAAI,EAAC,EACL,IAAI,GAAQ,OAAO,gBAAgB,YAAY,OAAO,GAAK,EAAE,WAAa,GAAa,GAEvF,GAAI,EAAO,CACT,GAAI,GAAY,GAAI,0BAAyB,GAC7C,EAAU,MAAQ,EAClB,EAAU,KAAO,GACjB,gBAAgB,MAAM,KAI1B,AAAC,KAAM,CAEL,GADI,CAAC,OAAO,iBACR,CAAC,OAAO,MAAM,KAAQ,OAW1B,GAAI,GAAW,EACT,EAAQ,YAAY,UAAW,CAtqBvC,MAuqBI,GAAY,EAEZ,GAAM,GAAS,EAAW,UAAO,MAAM,OAAb,OAAqB,IAE/C,GAAI,EAAO,OAAS,EAAG,CACrB,OAAW,KAAS,GAClB,EAAE,mBAAmB,OAAO,EAAE,YAAY,KAAK,QAAS,EAAM,UAAU,KAAK,aAAQ,EAAM,OAG7F,EAAE,oBAAoB,OAEtB,cAAc,GAEhB,AAAI,GAAY,IAEd,cAAc,IAEf,KAEH,WAAoB,EAAc,CAEhC,GAAM,GAAI,EAAK,MAAM,cACrB,GAAI,CAAC,EAAK,MAAO,GACjB,GAAM,GAAa,EAAE,GAGrB,MAAK,QAAO,gBACL,OAAO,gBAAgB,YAAY,OAAO,GAAS,EAAM,KAAK,WAAW,IAD1C,QAKnC,YAAwB,EAAgB,CAG7C,GADA,OAAO,MAAM,iBAAmB,GAC5B,CAAE,OAAO,MAAM,iBAAmB,CAAE,EAAK,QAAS,MAAO,KAC7D,EAAM,QAAQ,EAAK,MAAM,gBAAoB,GAGxC,YAAmB,EAAe,CACvC,EAAE,2BAA2B,KAAM,yEAA2E,EAAQ,eAGjH,YAA4B,CACjC,GAAI,CAGF,AADmB,IAAI,QAAQ,sBACpB,kBAAkB,EAAgB,QAAS,UAC/C,EAAP,CACA,QAAQ,MAAM,GAEhB,MAAO,kBAAiB,WAGnB,aAA0B,CAC/B,GAAM,GAAS,SAAS,eAAe,YACvC,GAAI,EAAQ,CACV,EAAO,UAAU,OAAO,UAExB,GAAM,GAAa,GAAI,YAAW,CAAC,WAEnC,WAAW,UAAU,CAAC,EAAO,UAAU,IAAI,WAAY,KACvD,EAAW,cAEX,GAAM,GAAiB,SAAS,eAAe,mBAC/C,AAAI,GACF,EAAe,UAAU,IAAI,WAK5B,YAAgC,EAAwB,CAC7D,AAAI,EAAE,sBAAsB,GAAG,YAC3B,GAAE,0BAA0B,OAC5B,EAAE,eAAe,QAGb,IACF,EAAE,0BAA0B,OAE9B,EAAE,eAAe,QAGrB,AAAI,EAAE,eAAe,GAAG,WACtB,GAAE,gBAAgB,YAAY,QAC9B,EAAE,gBAAgB,IAAI,SAAU,GAAK,MACrC,EAAE,gBAAgB,IAAI,SAAU,GAAK,OAErC,GAAE,gBAAgB,SAAS,QAC3B,EAAE,gBAAgB,OAAO,SACzB,EAAE,gBAAgB,OAAO,UC1uB7B,EAAE,UAAW,CACX,YAAuB,CACrB,EAAG,eAAe,OAClB,EAAG,aAAa,OAChB,EAAG,UAAU,OACb,EAAG,WAAW,QACd,EAAG,iBAAiB,QACpB,OAAO,MAAM,gBAAkB,GAGjC,WAAqB,EAAiB,CAhCxC,kBAkCI,GAAM,GAAM,EAAE,eAAiB,EAAU,MACnC,EAAU,EAAI,SAAS,eAGvB,EAAS,EAAE,qBAAuB,EAAU,MAC5C,EAAa,EAAO,SAAS,qBAGnC,EAAQ,YAAY,gBACpB,EAAI,SAAS,gBAEb,EAAW,SAAS,UACpB,EAAO,YAAY,UAEnB,GAAM,GAAwC,GAO9C,GANA,UAAO,MAAM,aAAb,QAAyB,IAAK,SAAS,EAAsB,CAC3D,EAAY,EAAU,YAAc,IAGtC,IAEI,IAAY,MAAO,CACrB,EAAG,mBAAmB,IAAI,aAAc,QACxC,EAAG,uBAAuB,OAC1B,EAAG,gBAAgB,OACnB,OAEF,EAAG,mBAAmB,IAAI,aAAc,QACxC,EAAG,uBAAuB,OAC1B,EAAG,gBAAgB,OAInB,AAAI,OAAO,MAAM,gBAAmB,QAAO,MAAM,uBAAyB,WAAa,EACrF,GAAG,iBAAiB,IAAK,OAAO,MAAM,eAAe,MACrD,eAAiB,SAAU,OAAO,MAAM,eAAe,OAGpD,AAAI,MAAW,KAAX,cAAqB,gBAC5B,GAAG,iBAAiB,IAAK,EAAW,GAAS,eAAgB,MAC7D,eAAiB,SAAU,EAAW,GAAS,eAAgB,OAG5D,AAAI,IAAY,SAAW,OAAO,MAAM,sBAAwB,OAAO,MAAM,gBAChF,GAAG,iBAAiB,IAAI,OAAO,MAAM,sBACrC,eAAiB,SAAS,OAAO,MAAM,kBAGvC,GAAG,iBAAiB,IAAK,EAAY,GAAS,kBAAoB,MAAQ,OAAO,MAAM,YAAc,IAAM,OAAO,MAAM,OACxH,eAAiB,SAAU,EAAY,GAAS,aAGlD,OAAO,MAAM,eAAiB,IAAY,QAAU,OAAY,EAChE,eAAiB,iBAEjB,OAAO,MAAM,gBAAkB,GAoBjC,GAjBA,EAAE,eAAe,MAAM,SAAU,EAAG,CAElC,GAAM,GAAU,AADJ,EAAE,EAAE,QACI,KAAK,OAEzB,EAAE,iBAGF,AAAI,OAAO,MAAM,gBAAiB,EAAM,QAAQ,EAAK,MAAM,gBAAoB,IAAM,EAAY,IAC5F,EAAY,GAGjB,GAAM,GAAe,IAAY,QAAU,EAAU,GACrD,AAAI,OAAO,SAAW,OAAO,QAAQ,aAAa,KAAM,GAAI,IAAM,KAKhE,OAAO,OAAS,OAAO,MAAM,eAC/B,EAAY,OAAO,MAAM,wBAElB,OAAO,SAAS,KAAM,CAE7B,GAAM,GAAe,OAAO,SAAS,KAAK,QAAQ,KAAM,IACxD,AAAI,GACF,EAAY,MCjHlB,YAA2B,EAAW,CACpC,GAAI,GAAwB,GAExB,EAAQ,EAAE,MAAM;AAAA,GAChB,EAAe,EAAM,IAAI,GAAK,KAAK,MAAM,EAAE,OAAS,IAExD,MAAO,IAAI,GAAgB,EAAM,OAGnC,YAAa,EAAc,CACzB,GAAI,GAAM,EACV,OAAW,KAAK,GACd,GAAO,EAET,MAAO,GAIT,YAAoB,EAA0B,CAC5C,GAAI,GAAQ,KAAK,IAAI,EAAG,GAAkB,EAAE,GAAI,QAC5C,EAAe,EAAQ,GAAK,EAGhC,AAAI,EAAE,GAAI,SAAqB,GAC7B,EAAE,GAAI,IAAI,CAAE,OAAQ,GAAG,QAI3B,EAAE,YAAY,KAAK,CAAC,EAAI,IAAO,GAAW,IAAK,GAAG,QAAS,GAAK,CAC9D,GAAM,GAAS,EAAE,EAAE,QACnB,AAAK,EAAO,SAAS,YACnB,GAAO,SAAS,WAIhB,EAAO,KAAK,OAAQ,EAAO,KAAK,SAEhC,GAAmB,EAAO,QAAQ,UAGpC,GAAW,KAIb,GAAI,IAAW,GAAI,KAEnB,YAA4B,EAAc,CACxC,GAAI,GAAW,EAAK,KAAK,QACrB,EAAW,GAAS,IAAI,GAE5B,GAAI,CAAC,EAAU,CACb,GAAI,GAAS,EAAE,qBAAuB,EAAW,MACjD,EAAW,CACT,OAAQ,EACR,QAAS,GAGX,GAAS,IAAI,EAAU,GAGzB,EAAS,SAAW,EACpB,EAAS,OAAO,KAAK,GAAG,MAAa,EAAS,YAGhD,EAAE,qBAAqB,MAAM,GAAK,CAChC,GAAI,GAAW,EAAE,EAAE,QAAQ,KAAK,QAC5B,EAAO,EAAE,mBAAqB,EAAW,MAC7C,EAAK",
  "names": []
}
